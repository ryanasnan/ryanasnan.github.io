

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1   Model Eloquent &mdash; laravel mdd 1.01 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="laravel mdd 1.01 documentation" href="index.html"/>
        <link rel="next" title="Relationship" href="relationship-eloquent.html"/>
        <link rel="prev" title="Database" href="database.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> laravel mdd
          

          
          </a>

          
            
            
              <div class="version">
                1.01
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="basic-concept.html">Konsep Dasar</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-architecture.html">Laravel Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-config.html">Konfigurasi Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-config.html#error-compiled-php">error <code class="docutils literal"><span class="pre">compiled.php</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="routing.html">Routing di Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html">Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="database.html#migration">Migration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">1&nbsp;&nbsp;&nbsp;Model Eloquent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#orm-object-relational-mapping">1.1&nbsp;&nbsp;&nbsp;ORM (<code class="docutils literal"><span class="pre">Object</span> <span class="pre">Relational</span> <span class="pre">Mapping</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#konfigurasi-eloquent">1.1.1&nbsp;&nbsp;&nbsp;Konfigurasi eloquent</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mengubah-nama-tabel-yang-berbeda-dan-mengubah-lokasi-model">1.1.2&nbsp;&nbsp;&nbsp;Mengubah nama tabel yang berbeda dan mengubah lokasi model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timestamp">1.1.3&nbsp;&nbsp;&nbsp;Timestamp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mengubah-primary-key">1.1.4&nbsp;&nbsp;&nbsp;Mengubah Primary key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mass-assignment">1.1.5&nbsp;&nbsp;&nbsp;Mass Assignment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#crud-dasar-dengan-eloquent">1.2&nbsp;&nbsp;&nbsp;CRUD dasar dengan Eloquent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#query-dalam-eloquent">1.3&nbsp;&nbsp;&nbsp;Query Dalam Eloquent</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fetch">1.3.1&nbsp;&nbsp;&nbsp;Fetch</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-constraint">1.3.2&nbsp;&nbsp;&nbsp;Query Constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="#soft-delete">1.3.3&nbsp;&nbsp;&nbsp;Soft Delete</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#query-scope">1.4&nbsp;&nbsp;&nbsp;Query Scope</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-scope">1.4.1&nbsp;&nbsp;&nbsp;Dynamic scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="#global-scope">1.4.2&nbsp;&nbsp;&nbsp;Global Scope</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#accessor-dan-mutator">1.5&nbsp;&nbsp;&nbsp;Accessor dan Mutator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mutator">1.5.1&nbsp;&nbsp;&nbsp;<strong>Mutator</strong></a></li>
<li class="toctree-l3"><a class="reference internal" href="#accessor">1.5.2&nbsp;&nbsp;&nbsp;Accessor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">1.5.3&nbsp;&nbsp;&nbsp;Accessor dan mutator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#event-dan-model-observer">1.6&nbsp;&nbsp;&nbsp;Event dan Model Observer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#penggunaan-property-dan-method-pada-data-dari-relasi-model">1.7&nbsp;&nbsp;&nbsp;Penggunaan property dan method pada data dari relasi model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#has-dan-wherehas">1.8&nbsp;&nbsp;&nbsp;has dan whereHas</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#has">1.8.1&nbsp;&nbsp;&nbsp;has</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#where-has">1.8.1.1&nbsp;&nbsp;&nbsp;where has</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hasmanythrough">1.9&nbsp;&nbsp;&nbsp;HasManyThrough</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mendefinisikan-relationship-di-laravel">1.10&nbsp;&nbsp;&nbsp;Mendefinisikan <cite>Relationship</cite> di Laravel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#polymorph-relation">1.10.1&nbsp;&nbsp;&nbsp;<cite>Polymorph Relation</cite></a></li>
<li class="toctree-l3"><a class="reference internal" href="#pendefinisian-relasi-polymorph">1.10.2&nbsp;&nbsp;&nbsp;Pendefinisian relasi polymorph</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#morph">1.10.2.1&nbsp;&nbsp;&nbsp;morph</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="relationship-eloquent.html">Relationship</a></li>
<li class="toctree-l1"><a class="reference internal" href="collection-eloquent.html">Collection Eloquent</a></li>
<li class="toctree-l1"><a class="reference internal" href="view.html">View</a></li>
<li class="toctree-l1"><a class="reference internal" href="controller.html">Controller</a></li>
<li class="toctree-l1"><a class="reference internal" href="request-response.html">Request dan Response di Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="validate.html">Laravel Validate</a></li>
<li class="toctree-l1"><a class="reference internal" href="middleware.html">Middleware</a></li>
<li class="toctree-l1"><a class="reference internal" href="authenticate-authorization-grant-access.html">Autentikasi</a></li>
<li class="toctree-l1"><a class="reference internal" href="authenticate-authorization-grant-access.html#autorize">Autorize</a></li>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validasi di Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="jobs.html">Jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-management.html">Manajemen FIle</a></li>
<li class="toctree-l1"><a class="reference internal" href="file-management.html#path-dan-url">Path dan URL</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-multi-branch-and-set-deploy.html">Multi Branch di Laravel dan setting untuk deploy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mobile-apps.html">Mobile Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository-pattern.html">Laravel Repository pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="repository-pattern.html#pembuatan-repository-pattern-di-laravel">Pembuatan Repository pattern di <code class="docutils literal"><span class="pre">Laravel</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="repository-pattern.html#authorize-di-dalam-repository-pattern">Authorize di dalam Repository pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-simple-register-activation.html">Registrasi Akun Laravel dan Aktivasi Akun</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-new-project-recommended-structure.html">Rekomendasi struktur project baru laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-tips.html">Laravel Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-emergency.html">Catatan laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-emergency.html#routing-note">Routing note</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-emergency.html#laravel-script-code-structure">Laravel Script Code Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-emergency.html#laravel-path-dan-url-untuk-menggunakan-file">Laravel Path dan URL untuk menggunakan file</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-emergency.html#laravel-token-mismatch-exception">Laravel token mismatch exception</a></li>
<li class="toctree-l1"><a class="reference internal" href="timezone-laravel.html">Timezone Laravel</a></li>
<li class="toctree-l1"><a class="reference internal" href="laravel-problem-and-solving.html">Masalah Laravel dan pemecahannya</a></li>
<li class="toctree-l1"><a class="reference internal" href="artisan-console.html">Artisan Console (CLI laravel)</a></li>
<li class="toctree-l1"><a class="reference internal" href="artisan-console.html#contoh-penggunaan-command-laravel-dalam-export-import-database-mysql">Contoh penggunaan command laravel dalam export import database mysql</a></li>
<li class="toctree-l1"><a class="reference internal" href="content-baru.html">Content Baru</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">laravel mdd</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>1&nbsp;&nbsp;&nbsp;Model Eloquent</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/model-eloquent.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="model-eloquent">
<h1><a class="toc-backref" href="#id2">1&nbsp;&nbsp;&nbsp;Model Eloquent</a><a class="headerlink" href="#model-eloquent" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="auto-toc simple">
<li><a class="reference internal" href="#model-eloquent" id="id2">1&nbsp;&nbsp;&nbsp;Model Eloquent</a><ul class="auto-toc">
<li><a class="reference internal" href="#orm-object-relational-mapping" id="id3">1.1&nbsp;&nbsp;&nbsp;ORM (<code class="docutils literal"><span class="pre">Object</span> <span class="pre">Relational</span> <span class="pre">Mapping</span></code>)</a><ul class="auto-toc">
<li><a class="reference internal" href="#konfigurasi-eloquent" id="id4">1.1.1&nbsp;&nbsp;&nbsp;Konfigurasi eloquent</a></li>
<li><a class="reference internal" href="#mengubah-nama-tabel-yang-berbeda-dan-mengubah-lokasi-model" id="id5">1.1.2&nbsp;&nbsp;&nbsp;Mengubah nama tabel yang berbeda dan mengubah lokasi model</a></li>
<li><a class="reference internal" href="#timestamp" id="id6">1.1.3&nbsp;&nbsp;&nbsp;Timestamp</a></li>
<li><a class="reference internal" href="#mengubah-primary-key" id="id7">1.1.4&nbsp;&nbsp;&nbsp;Mengubah Primary key</a></li>
<li><a class="reference internal" href="#mass-assignment" id="id8">1.1.5&nbsp;&nbsp;&nbsp;Mass Assignment</a></li>
</ul>
</li>
<li><a class="reference internal" href="#crud-dasar-dengan-eloquent" id="id9">1.2&nbsp;&nbsp;&nbsp;CRUD dasar dengan Eloquent</a></li>
<li><a class="reference internal" href="#query-dalam-eloquent" id="id10">1.3&nbsp;&nbsp;&nbsp;Query Dalam Eloquent</a><ul class="auto-toc">
<li><a class="reference internal" href="#fetch" id="id11">1.3.1&nbsp;&nbsp;&nbsp;Fetch</a></li>
<li><a class="reference internal" href="#query-constraint" id="id12">1.3.2&nbsp;&nbsp;&nbsp;Query Constraint</a></li>
<li><a class="reference internal" href="#soft-delete" id="id13">1.3.3&nbsp;&nbsp;&nbsp;Soft Delete</a></li>
</ul>
</li>
<li><a class="reference internal" href="#query-scope" id="id14">1.4&nbsp;&nbsp;&nbsp;Query Scope</a><ul class="auto-toc">
<li><a class="reference internal" href="#dynamic-scope" id="id15">1.4.1&nbsp;&nbsp;&nbsp;Dynamic scope</a></li>
<li><a class="reference internal" href="#global-scope" id="id16">1.4.2&nbsp;&nbsp;&nbsp;Global Scope</a></li>
</ul>
</li>
<li><a class="reference internal" href="#accessor-dan-mutator" id="id17">1.5&nbsp;&nbsp;&nbsp;Accessor dan Mutator</a><ul class="auto-toc">
<li><a class="reference internal" href="#mutator" id="id18">1.5.1&nbsp;&nbsp;&nbsp;<strong>Mutator</strong></a></li>
<li><a class="reference internal" href="#accessor" id="id19">1.5.2&nbsp;&nbsp;&nbsp;Accessor</a></li>
<li><a class="reference internal" href="#id1" id="id20">1.5.3&nbsp;&nbsp;&nbsp;Accessor dan mutator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-dan-model-observer" id="id21">1.6&nbsp;&nbsp;&nbsp;Event dan Model Observer</a></li>
<li><a class="reference internal" href="#penggunaan-property-dan-method-pada-data-dari-relasi-model" id="id22">1.7&nbsp;&nbsp;&nbsp;Penggunaan property dan method pada data dari relasi model</a></li>
<li><a class="reference internal" href="#has-dan-wherehas" id="id23">1.8&nbsp;&nbsp;&nbsp;has dan whereHas</a><ul class="auto-toc">
<li><a class="reference internal" href="#has" id="id24">1.8.1&nbsp;&nbsp;&nbsp;has</a><ul class="auto-toc">
<li><a class="reference internal" href="#where-has" id="id25">1.8.1.1&nbsp;&nbsp;&nbsp;where has</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#hasmanythrough" id="id26">1.9&nbsp;&nbsp;&nbsp;HasManyThrough</a></li>
<li><a class="reference internal" href="#mendefinisikan-relationship-di-laravel" id="id27">1.10&nbsp;&nbsp;&nbsp;Mendefinisikan <cite>Relationship</cite> di Laravel</a><ul class="auto-toc">
<li><a class="reference internal" href="#polymorph-relation" id="id28">1.10.1&nbsp;&nbsp;&nbsp;<cite>Polymorph Relation</cite></a></li>
<li><a class="reference internal" href="#pendefinisian-relasi-polymorph" id="id29">1.10.2&nbsp;&nbsp;&nbsp;Pendefinisian relasi polymorph</a><ul class="auto-toc">
<li><a class="reference internal" href="#morph" id="id30">1.10.2.1&nbsp;&nbsp;&nbsp;morph</a><ul class="auto-toc">
<li><a class="reference internal" href="#morphto" id="id31">1.10.2.1.1&nbsp;&nbsp;&nbsp;morphTo</a></li>
<li><a class="reference internal" href="#many-to-many-polymorph-relation" id="id32">1.10.2.1.2&nbsp;&nbsp;&nbsp;<cite>Many to Many Polymorph Relation</cite></a><ul class="auto-toc">
<li><a class="reference internal" href="#insert-dan-update-data-pada-relasi-polymorph" id="id33">1.10.2.1.2.1&nbsp;&nbsp;&nbsp;Insert dan Update data pada relasi polymorph</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="orm-object-relational-mapping">
<h2><a class="toc-backref" href="#id3">1.1&nbsp;&nbsp;&nbsp;ORM (<code class="docutils literal"><span class="pre">Object</span> <span class="pre">Relational</span> <span class="pre">Mapping</span></code>)</a><a class="headerlink" href="#orm-object-relational-mapping" title="Permalink to this headline">¶</a></h2>
<p>ORM (Object Relational Mapping) dalam software komputer diartikan sebagai teknik pemrograman yang menkonversi data berbagai tipe sistem ke dalam bahasa OOP.</p>
<p>ORM ini akan membentuk semacam object <code class="docutils literal"><span class="pre">virtual</span> <span class="pre">database</span></code> yang mana dapat diakses/digunakan dari dalam bahasa pemrograman yang menggunakannya.</p>
<p>Laravel memiliki ORM tersendiri, yaitu <code class="docutils literal"><span class="pre">eloquent</span></code>.</p>
<p>Eloquent ini memiliki banyak fitur built in yang cukup membantu terutama pada relasi antar tabel.</p>
<p>Eloquent dapat menangani relasi antar tabel seperti <code class="docutils literal"><span class="pre">One</span> <span class="pre">to</span> <span class="pre">One</span></code>, <code class="docutils literal"><span class="pre">One</span> <span class="pre">to</span> <span class="pre">Many</span></code>, <code class="docutils literal"><span class="pre">Many</span> <span class="pre">to</span> <span class="pre">Many</span></code>, <code class="docutils literal"><span class="pre">Has</span> <span class="pre">many</span> <span class="pre">through</span></code>, <code class="docutils literal"><span class="pre">Polymorphic</span> <span class="pre">relation</span></code> dan <code class="docutils literal"><span class="pre">Many</span> <span class="pre">To</span> <span class="pre">Many</span> <span class="pre">Polymorphic</span> <span class="pre">Relations</span></code>.</p>
<p>Berikut fitur yang ada pada Eloquent :</p>
<ul class="simple">
<li>Mass Assignment</li>
<li>Soft Deleting</li>
<li>Timestamps</li>
<li>Query Scopes</li>
<li>Eager Loading</li>
<li>Accessors &amp; Mutators</li>
<li>Attribute Casting</li>
<li>Model Events</li>
<li>Model Observers</li>
<li>Model URL Generation</li>
<li>Converting To Arrays / JSON</li>
</ul>
<div class="section" id="konfigurasi-eloquent">
<h3><a class="toc-backref" href="#id4">1.1.1&nbsp;&nbsp;&nbsp;Konfigurasi eloquent</a><a class="headerlink" href="#konfigurasi-eloquent" title="Permalink to this headline">¶</a></h3>
<p>Dalam menggunakan eloquent laravel maka terdapat beberapa hal yang perlu untuk diperhatikan.</p>
<p>Dalam satu class eloquent mewakili satu tabel dalam database, dan class ini sering pula diartikan sebagai model, karena memodelkan dari tabel yang diwakilkan.</p>
<p>Terdapat aturan penamaan antara tabel dengan model di laravel, yaitu pada tabel harus bernama <strong>plural</strong> atau jamak (s/es) sedangkan pada model harus bernama <strong>singular</strong> atau tunggal(tanpa s/es).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Penggunaan plural dan singular diatas hanya untuk memudahkan saja dalam menipulasi di model, karena laravel telah menyediakan fitur khusus yang akan mengambil tabel sebagai model secara default, yaitu dari metode plural dan singular tersebut.</p>
<p class="last">Suatu tabel yang akan digunakan pada laravel dapat memiliki nama model yang lain (tidak menggunakan plural ataupun singular dari nama tabelnya).</p>
</div>
<p>Tentunya laravel memiliki cara tersendiri dalam membuat konfigurasi jika semisal nama antara tabel dengan model berbeda, yaitu dengan membuat property <code class="docutils literal"><span class="pre">table</span></code> dengan isian string nama tabel yang akan digunakan pada model tersebut.</p>
<p>Setelah membuat adanya tabel maka untuk membuat model bisa dilakukan dengan command : php artisan make:model Nama_tabel_singular, jangan lupa untuk memberikan huruf besar di depan(camelcase).</p>
<p>Setelahnya akan tercipta file baru di direktori <code class="docutils literal"><span class="pre">app</span></code>.</p>
<p>Setelah membuat model kita bisa mengakses tabel melalui model ini, semisal akan menampilkan data dengan id = 1:</p>
<img alt="_images/7.1.1eloquent.jpg" src="_images/7.1.1eloquent.jpg" />
<p>hal yang perlu diingat adalah dalam melakukan manipulasi basic masih menggunakan dengan query builder, artinya kita hanya mengubah <code class="docutils literal"><span class="pre">DB::table('nama_tabel')</span></code> dengan <code class="docutils literal"><span class="pre">nama_model::</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pembuatan singular dan plural
Dalam membuat tabel terkadang kita tidak menggunakan bahasa inggris dari tabel tersebut sehingga tidak mengerti apa nama plural dan singularnya, selain itu ada beberapa aturan dalam penamaan plural singular yang tidak umum, maka dari itu laravel memiliki cara tersendiri dalam mengetahuinya, yaitu dengan menggunakan syntax ‘str_plural(‘nama_singular’)’ yang akan mengetahui nama jamak(plural) dan ‘str_singular(‘nama_plural’)’ yang akan mengetetahui nama singularnya.</p>
</div>
<img alt="_images/6.1.1.1.convertSingularPlural.jpg" src="_images/6.1.1.1.convertSingularPlural.jpg" />
<p>Namun perlu diperhatikan bahwa saat membuat model yang menggunakan underscore, maka selanjutnya laravel akan menghilangkan underscore tersebut dan merubah huruf di belakang underscore menjadi huruf besar, misal</p>
<p><code class="docutils literal"><span class="pre">php</span> <span class="pre">artisan</span> <span class="pre">make:model</span> <span class="pre">membership_type</span></code> maka nantinya akan berubah menjadi <code class="docutils literal"><span class="pre">MembershipType</span></code> pada model.</p>
</div>
<div class="section" id="mengubah-nama-tabel-yang-berbeda-dan-mengubah-lokasi-model">
<h3><a class="toc-backref" href="#id5">1.1.2&nbsp;&nbsp;&nbsp;Mengubah nama tabel yang berbeda dan mengubah lokasi model</a><a class="headerlink" href="#mengubah-nama-tabel-yang-berbeda-dan-mengubah-lokasi-model" title="Permalink to this headline">¶</a></h3>
<p>Nama antara model dengan tabel dapat berbeda dengan cara memberikan value pada property <code class="docutils literal"><span class="pre">table</span></code> seperti</p>
<p>protected $table = <code class="docutils literal"><span class="pre">barang_yang_dikirimkan</span></code>;</p>
<p>selain itu kita juga dapat memindahkan lokasi model sehingga tidak selalu berada pada direktori <code class="docutils literal"><span class="pre">app</span></code> dengan cara memberikan tambahan pada namespace pada model, misal:</p>
<p>kita memindah semua model ke dalam direktori <code class="docutils literal"><span class="pre">App/Model</span></code></p>
<p>maka setiap file model pada namespace kita ganti menjadi <code class="docutils literal"><span class="pre">namespace</span> <span class="pre">App\Model;</span></code></p>
</div>
<div class="section" id="timestamp">
<h3><a class="toc-backref" href="#id6">1.1.3&nbsp;&nbsp;&nbsp;Timestamp</a><a class="headerlink" href="#timestamp" title="Permalink to this headline">¶</a></h3>
<p>Secara default ketika membuat suatu migration maka akan terdapat method <code class="docutils literal"><span class="pre">timestamps</span></code>, method ini akan membuat 2 field yaitu <code class="docutils literal"><span class="pre">created_at</span></code> dan <code class="docutils literal"><span class="pre">updated_at</span></code>.</p>
<p>Ketika kita tidak membuat field ini maka saat menjalankan query dengan ORM eloquent akan muncul error.</p>
<p>berikut adalah cara dalam menambahkan data dengan objet eloquent, perlu diketahui kita harus membuat object terlebih dahulu pada model untuk kemudian baru memanipulasinya.</p>
<p>Contoh berikut tidak mengguanakan timestamps(tidak terdapat field <code class="docutils literal"><span class="pre">created_at</span></code> dan <code class="docutils literal"><span class="pre">updated_at</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $mbPro = new App\Product;
=&gt; &lt;App\Product #00000000714e53d80000000052ee6663&gt; {}
&gt;&gt;&gt; $mbPro-&gt;name = &quot;MacBook Pro 2015&quot;
=&gt; &quot;MacBook Pro 2015&quot;
&gt;&gt;&gt; $mbPro-&gt;description = &quot;Retina Display&quot;;
=&gt; &quot;Retina Display&quot;
&gt;&gt;&gt; $mbPro-&gt;price = 24000000;
=&gt; 24000000
&gt;&gt;&gt; $mbPro-&gt;stock = 18;
=&gt; 18
&gt;&gt;&gt; $mbPro-&gt;save();
Illuminate\Database\QueryException with message &#39;SQLSTATE[42S22]: Column not found: 1054 Unknown column &#39;updated_at&#39; in &#39;field list&#39; (SQL: insert into `products` (`name`, `description`, `price`, `stock`, `updated_at`, `created_at`) values (MacBook Pro 2015, Retina Display, 24000000, 18, 2016-04-27 00:56:35, 2016-04-27 00:56:35))&#39;
</pre></div>
</div>
<p>Terlihat bahwa query sql salah dikarenakan terdapat value tanggal dimasukkan namun tidak terdapat adanya field(pada ‘2016-04-27 00:56:35, 2016-04-27 00:56:35’).</p>
<p>Tapi ingat ini hanya berlaku pada object eloquent ,sedangkan pada query builder biasa tidak akan terpengaruh.</p>
<p>Dalam materi seelumnya yaitu <code class="docutils literal"><span class="pre">seeding</span></code> mengapa field <code class="docutils literal"><span class="pre">created_at</span> <span class="pre">``</span> <span class="pre">dan</span> <span class="pre">``updated_at</span></code> kosong, hal itu dikarenakan kita tidak menggunakan object model(eloquent) namun hanya melakukan insert dengan query builder.</p>
<p>Untuk menghilangkan fitur ini kita dapat menambahkan property <code class="docutils literal"><span class="pre">timestamps</span></code> yang bervalue <code class="docutils literal"><span class="pre">false</span></code> , misalkan</p>
<p><code class="docutils literal"><span class="pre">protected</span> <span class="pre">$timestamps</span> <span class="pre">=</span> <span class="pre">false;</span></code></p>
<p>Dan sebagai tambahan laravel akan menggunakan UTC, sehingga saat memasukkan data dengan model maka catatan waktunya agak berbeda, oleh karena itu sebaiaknya diubah terlebih dahulu konfigurasi UTC pada <code class="docutils literal"><span class="pre">config/app.php</span></code> pada bagian timezone ubah menjadi <code class="docutils literal"><span class="pre">Asia/Jakarta</span></code>.</p>
</div>
<div class="section" id="mengubah-primary-key">
<h3><a class="toc-backref" href="#id7">1.1.4&nbsp;&nbsp;&nbsp;Mengubah Primary key</a><a class="headerlink" href="#mengubah-primary-key" title="Permalink to this headline">¶</a></h3>
<p>Laravel memiliki aturan dalam penamaan field yaitu setiap primary key harus bernama <code class="docutils literal"><span class="pre">id</span></code>.</p>
<p>Jika tidak maka penggunaan model akan error.</p>
<p>Tentu tidak masalah ketika akan membuat database secara awal dengan laravel, namun bagaimana jika sudah terdapat database dari luar dan strukturnya fieldnya sudah ditentukan, mungkin akan sulit dalam memanipulasinya.</p>
<p>Untuk mengubah primary key dalam eloquent maka dapat menambahkan property <code class="docutils literal"><span class="pre">primaryKey</span></code> dengan value adalah field yang dijadikan primary key misal:</p>
<p><code class="docutils literal"><span class="pre">protected</span> <span class="pre">$primaryKey</span> <span class="pre">=</span> <span class="pre">productd_id;</span></code></p>
</div>
<div class="section" id="mass-assignment">
<h3><a class="toc-backref" href="#id8">1.1.5&nbsp;&nbsp;&nbsp;Mass Assignment</a><a class="headerlink" href="#mass-assignment" title="Permalink to this headline">¶</a></h3>
<p>Syntax dasar dalam melakukan insert dan update dengan model adalah dengan membuat object dari model tersebut kemudian mengisikan <code class="docutils literal"><span class="pre">field</span></code> nya pada property dengan value, kemudian melakukan method save() seperti pada contoh timestamps diatas</p>
<img alt="_images/7.2.1.massassignment.jpg" src="_images/7.2.1.massassignment.jpg" />
<p>Kemudian bagaimanakah jika kita akan memasukkan/mengedit data tanpa harus menggunakan property object model dalam satu syntax???</p>
<p>Kita dapat menggunakan mass assignment, yaitu memperbolehkan laravel untuk melakukan insert/update lebih dari satu data.</p>
<p>Dengan memberikan mass assignment maka kita dapat menggunakan method <code class="docutils literal"><span class="pre">create()</span></code> dan <code class="docutils literal"><span class="pre">update()</span></code></p>
<p>dengan menggunakan method <code class="docutils literal"><span class="pre">create</span></code> ini maka akan mempermudah dalam memasukkan/mengedit data pada database.</p>
<p>data yang akan dimasukkan akan dipassing ke dalam method <code class="docutils literal"><span class="pre">create</span></code> dalam bentuk array assosiatif, misal :</p>
<p>untuk insert data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$model = Model::create([&quot;field1&quot;=&gt;&quot;value&quot;, &quot;field2&quot;=&gt;&quot;value&quot;]);
</pre></div>
</div>
<p>untuk update data maka kita harus mendapatkan dahulu datanya dengan seleksi:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$model = Model::find(1);
$model-&gt;update([&quot;field1&quot;=&gt;&quot;value&quot;, &quot;field2&quot;=&gt;&quot;value&quot;]);
</pre></div>
</div>
<p>Selain itu jika semisal kita memiliki addanya input yang sangat banyak , semisal memiliki 20 field dan semua data array sudah ada (pas dengan field) , maka kita dapat menggunakan syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$model = Model::create(Input::all());
</pre></div>
</div>
<p>Namun sebelum menggunakan fitur mass assignment ini kita harus memberikan koonfigurasi pada field mana yang dapat menggunakan mass_assignment.</p>
<p>Terdapat 2 jenis cara dalam menentukan field yang menggunakan mass assignment :</p>
<ol class="arabic simple">
<li><strong>whitelist</strong></li>
</ol>
<blockquote>
<div><p>teknik ini adalah memberitahu field mana yang dapat diisi jika menggunakan method <code class="docutils literal"><span class="pre">create</span></code> atau <code class="docutils literal"><span class="pre">update</span></code>.</p>
<p>Caranya dengan menambahkan property <code class="docutils literal"><span class="pre">fillable</span></code> pada file model dengan value berupa array 1 dimensi yangg berisikan nama fieldnya, misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>protected $fillable = [`nama`,`jumlah`];
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><strong>blacklist</strong></li>
</ol>
<blockquote>
<div><p>teknik ini adalah kebalikan dari whitelist,</p>
<p>caranya adalah menambahkan property <code class="docutils literal"><span class="pre">guarded</span></code> pada file model dengan value berupa array 1 dimensi yang berisikan nama fieldnya, misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>protected $guarded = [`nama`,`jumlah`];
</pre></div>
</div>
</div></blockquote>
<p>Sebagai tambahan ketika kita telah menetukan field mana saja yang dapat diisi dan tidak, maka ketika kita masih mengisikan dengan method <code class="docutils literal"><span class="pre">create</span></code> dan <code class="docutils literal"><span class="pre">update</span></code> hasil daripada field nya adalah NULL.</p>
<p>Untuk mengisinya bisa menggunakan syntax query dasar eloquent</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Penggunaan query syntax dasar pada eloquent sangat jarang digunakan.</p>
<p class="last">Dari pengamatan penulis biasanya banyak program laravel yang menggunakan fitur mass assignment, sehingga ketika insert atau update data menggunakan method <code class="docutils literal"><span class="pre">create()</span></code> dan <code class="docutils literal"><span class="pre">update()</span></code>.</p>
</div>
<p>Fitur mass assignemnt ini memiliki banyak kegunaan diantaranya, pada aplikasi posting terdapat user <code class="docutils literal"><span class="pre">member</span></code>, user ini dapat mengisi pada field <code class="docutils literal"><span class="pre">title</span></code> dan <code class="docutils literal"><span class="pre">content</span></code> namun tidak dapat mengubah field <code class="docutils literal"><span class="pre">published</span></code>.</p>
<p>Ini dikarenakan telah terdapat whitelist pada field <code class="docutils literal"><span class="pre">title</span></code> dan <code class="docutils literal"><span class="pre">content</span></code> saja.</p>
<p>Dan nantinya admin dapat mengubah field <code class="docutils literal"><span class="pre">published</span></code> ini dengan query syntax dasar eloquent(tidak menggunakan method create atau update).</p>
<p>Tentu ini jauh lebih aman, meskipun kita sendiri dapat mendesain pada aplikasi untuk tidak membuat adanya celah pada user member untuk melakukan pengubahan field <code class="docutils literal"><span class="pre">published</span></code></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Meskipun dinamakan mass assignment namun bukan berarti kita dapat menambahkan/mengedit data dalam satu syntax, seperti misalkan dengan method <code class="docutils literal"><span class="pre">create</span></code> dan <code class="docutils literal"><span class="pre">update</span></code> kita tidak dapat menambahkan lagi data yang dapat dimasukkan.</p>
<p>Artinya hanya satu data yang dapat masuk atau satu data yang dapat diedit.</p>
<p class="last">Satu-satunya cara dalam melakukan insert/update lebih dari satu data dalam satu syntax adalah dengan query builder.</p>
</div>
</div>
</div>
<div class="section" id="crud-dasar-dengan-eloquent">
<h2><a class="toc-backref" href="#id9">1.2&nbsp;&nbsp;&nbsp;CRUD dasar dengan Eloquent</a><a class="headerlink" href="#crud-dasar-dengan-eloquent" title="Permalink to this headline">¶</a></h2>
<p>Dalam ORM eloquent maka dalam memanipulasi data di dalam database sedikit berbeda, untuk menggunakan setiap syntax CRUD maka kita harus membuat object model tersebut baru kita dapat memanipulasinya.</p>
<p>Method yang digunakan tidaklah sama dengan query builder.</p>
<p>Sangat disarankan untuk menggunakan fitur <code class="docutils literal"><span class="pre">mass_assignment</span></code> sehingga setiap memanipulasi data seperti insert dan update jauh lebih mudah.</p>
<p>Perlu diketahui bahwa ketika kita menggunakan object dari eloquent maka kita hanya dapat memanipulasi pada satu data saja.</p>
<img alt="_images/7.3.1.crudeloquent.jpg" src="_images/7.3.1.crudeloquent.jpg" />
<p>ingat kita hanya dapat memanipulasi pada satu data saja dengan menggunakan eloquent</p>
<img alt="_images/7.3.2.crudeloquent2.jpg" src="_images/7.3.2.crudeloquent2.jpg" />
<p>cara lain dalam menambah data adalah membuat object model lalu mengisi semua propertynya dan menjalankan method save()</p>
<img alt="_images/7.3.2.crudeloquent2.jpg" src="_images/7.3.2.crudeloquent2.jpg" />
<p>untuk mencari data dengan id tertentu, dengan lebih dari satu</p>
<img alt="_images/7.3.3.selecteloquent.jpg" src="_images/7.3.3.selecteloquent.jpg" />
<p>selain itu kita juga dapat mencari data dengan method ‘findOrFail’, perbedaanya adalah jika id tidak ada maka akan muncul error exxception</p>
<img alt="_images/7.3.4.selecteloquent2.jpg" src="_images/7.3.4.selecteloquent2.jpg" />
<p>Dan sebenarnya kita juga dapat membuat exception sendiri dari method ‘findOrFail’ ini.</p>
<img alt="_images/7.3.6.selecteloquent4.jpg" src="_images/7.3.6.selecteloquent4.jpg" />
<img alt="_images/7.3.5.selecteloquent3.jpg" src="_images/7.3.5.selecteloquent3.jpg" />
<img alt="_images/7.3.7.selecteloquent5.jpg" src="_images/7.3.7.selecteloquent5.jpg" />
<p>update dengan method update</p>
<img alt="_images/7.3.8.updateeloquent.jpg" src="_images/7.3.8.updateeloquent.jpg" />
<p>update dengan query eloquent , hehe lupa menggunakan method save()</p>
<img alt="_images/7.3.9.updateeloquent2.jpg" src="_images/7.3.9.updateeloquent2.jpg" />
<p>delete, menggunakan method delete()</p>
<img alt="_images/7.3.10.deleteeloquent.jpg" src="_images/7.3.10.deleteeloquent.jpg" />
</div>
<div class="section" id="query-dalam-eloquent">
<h2><a class="toc-backref" href="#id10">1.3&nbsp;&nbsp;&nbsp;Query Dalam Eloquent</a><a class="headerlink" href="#query-dalam-eloquent" title="Permalink to this headline">¶</a></h2>
<p>Dalam eloquent proses penulisan query membutuhkan 3 unsur yaitu :</p>
<p>1.``Model``</p>
<p>2.``Query Constraint``</p>
<p>3.``Fetch``</p>
<p>Model adalah model yang digunakan dalam mengakses tabel.</p>
<p>Query Constraint adalah kriteria yang akan diberikan untuk mendapatkan data sesuai dengan kebutuhan, biasanya dalam query constraint menggunakan method <code class="docutils literal"><span class="pre">where</span></code>.</p>
<p>Fetch adalah pengekseksekusian kode yang diberikan atau untuk mendapatkan data dari tabel yang telah diberikan kriteria tertentu.</p>
<p>Secara teori, query constraint dapat berjumlah lebih dari satu, sedangkan fetch hanya satu:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Model</span><span class="p">::</span><span class="n">constraint</span><span class="p">()</span>
<span class="o">-&gt;</span><span class="n">constraint</span><span class="p">()</span>
<span class="o">-&gt;</span><span class="n">constraint</span><span class="p">()</span>
<span class="o">-&gt;</span><span class="n">fetch</span><span class="p">();</span>
</pre></div>
</div>
<p>Namun query constraint itu bersifat opsional, karena dalam beberapa query seperti mendapatkan semua data atau query sederhana lain tidak memerliukan query constraint.</p>
<div class="section" id="fetch">
<h3><a class="toc-backref" href="#id11">1.3.1&nbsp;&nbsp;&nbsp;Fetch</a><a class="headerlink" href="#fetch" title="Permalink to this headline">¶</a></h3>
<p>Berikut adalah beberapa method dalam fetch query, beberapa diantaranya sudah digunakan pada materi sebelumnya</p>
<ul>
<li><p class="first">find : mencari satu record</p>
</li>
<li><p class="first">findOrFail : mencari satu record, apabila tidak ditemukan akan mengakses exception</p>
</li>
<li><p class="first">all : mengambil semua data</p>
</li>
<li><p class="first">first : mengambil record pertama dalam tabel</p>
</li>
<li><p class="first">findOrNew : mencari satu record berdasarkan dari id, dan ketika tidak diketemukan idnya maka akan membuat record baru, namun masih dalam bentuk object model, dan harus mengisikan atribut baru menjalankan method save:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$product = App\Product::findOrNew(20);
</pre></div>
</div>
<p>$product-&gt;name = “iPad Air”;
“iPad Air”
$product-&gt;save();</p>
</li>
<li><p class="first">FirstOrCreate : mencari record dengan kriteria(field) tertentu dan jika tidak diketemukan akan langsung membuat record tersebut:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$mbAir = App\Product::firstOrCreate([&#39;name&#39;=&gt;&#39;MacBook Air&#39;]); //jika tidak ada data dengan &#39;name&#39; MacBook Air maka akan langsung membuat record.
</pre></div>
</div>
</li>
<li><p class="first">FirstOrNew : hampir sama dengan firstOrCreate, perbedaannya adalah query ini tidak akan mentyimpan datanya sampai menjalankan method save():</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$appleWatch = App\Product::firstOrNew([&#39;name&#39;=&gt;&#39;Apple Watch&#39;,&#39;price&#39;=&gt;500000 0]);
</pre></div>
</div>
<p>$appleWatch-&gt;description = ‘Sport Blue’;
$appleWatch-&gt;stock = 12;
$appleWatch-&gt;save();</p>
</li>
<li><p class="first">get : method ini harus digunakan ketika terdapat query constraint</p>
<p>AppProduct::where(‘stock’, ‘&gt;’, 30)-&gt;get();</p>
</li>
<li><p class="first">update : mehtod ini untuk mengupdate record, method ini harus terdapar adanya query constriant(untuk mendapatkan datanya terlebih dahulu)</p>
<p>AppProduct::whereIn(‘id’,[1,3,4])-&gt;update([‘stock’=&gt;50]);</p>
</li>
<li><p class="first">lists : mendapatkan data pada satu/ beberapa field</p>
</li>
<li><p class="first">pluck : mendapatkan satu data saja pada satu/beberapa field</p>
</li>
<li><p class="first">toSql : akan menampilkan query sql yang dijalankan, kan sangat berguna ketika terdapat adanya error atau debug.</p>
</li>
<li><p class="first">delete : akan menghapus record, penggunaanya harus terdapat adanya query constraint</p>
<p>AppProduct::whereNull(‘description’)-&gt;delete()</p>
</li>
<li><p class="first">aggregate : merupakan method yang akan menghitung data pada tabel , terdapat banyak method semisal adalah count() yang akan menghitung jumlah baris</p>
</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Dalam melakukan firstOrCreate atau firstOrNew maka setiap model harus mendeklarasikan mass assignment pada setiap field jika tidak akan gagal.</p>
<p>kemudian bagaimana pengaplikasiannya ???</p>
<p>Jika pada firstOrCreate ketika kriteria tidak ditemukan akan dibuat, ini tentu sangatlah mudah</p>
<p>misalkan mencari data barang dengan nama TV polytron degan jumlah 10 , jika tidak ada maka akan langsung dibuat</p>
<img alt="_images/6.1.24.querybuilderaja.jpg" src="_images/6.1.24.querybuilderaja.jpg" />
<p>keterangan syntax pencarian yang diberikan kotak warna merah diatas tentu tidak diaplikasikan pada penggunaan firstOrCreate nantinya, diatas cuma contoh saja bahwa data barang dengan nama ‘TV Polytron’ dan jumlah 10 memang belumada</p>
<p>nah pengaplikasiannya cukup mudah pada firstOrCreate ini</p>
<p>namun pada firstOrNew maka ketika data tidak ada maka hanya akan dibuatkan object tanpa me-save object tersebut ke dalam database</p>
<p>pada firstOrNew rasanya pengaplikasiannya jauh lebi sulit, karena dibutuhkan adanya method save().</p>
<p>kapan method save ini dijalankan ???</p>
<p class="last">Apakah kita akan menggunakan method firstOrCreate atau firstOrNew ??</p>
</div>
<p>Tergantung dari aplikasi yang akan dibuat. karena memang tidak kesemua aplikasi membutuhkan method ini.</p>
<blockquote>
<div><p>Misalkan saja kita memiliki aplikasi pengolahan nilai pada siswa.</p>
<p>Misalkan terdapat nilai Tugas harian dan nilai Ulangan harian.</p>
<p>Tentu untuk memberkan nilai secara frekuentif seperti tugas harian 1 tugas harian 2 atau nilai ulangan harian1 nilai ulangan harian 2 maka dibutuhkan adanya 2 tabel yaitu tabel kategori nilai yang akan menyimpan nilai berdasarkan kategori (seperti tugas harian atau ulangan harian) serta menyimpan frekuensi nya dan tabel nilai yang akan memasukkan nilai berdasarkan dari kategori nilai</p>
<p>Maka ketika akan melakukan penambahan data nilai ,ketika belum ada kategori nilai maka tabel nilai juga tidak akan diisi(karena belum mendapatkan id dariapada kategori nilai).</p>
<p>Sehingga dibutuhkan method firstOrNew atau firstOrCreate di tabel nilai sehingga ketika nantinya belum ada kategori nilai akan dibuatkan terlebih dahulu.</p>
<p>Atau bagaimana jika kita memiliki adanya aplikasi penjualan</p>
<p>misalkan ada pembeli melakukan pembelian barang</p>
<p>nah jika pembeli tersebut baru maka kita akan membuatkan datanya(nama,almat,telepon)</p>
<p>nah bagaimana jika pembeli tersebut datang lagi</p>
<p>apakah mungkin kita akan membuatakan lagi data pembelinya, tentu tidak kan</p>
</div></blockquote>
<p>contoh lain yang lebih konkrit adalah ketika kita membuka suatu pengaturan akun , namun ternyata belum ada datanya , padahal data ini sebenarnya berelasi dengan tabel lain, maka kita dapat melakukan penambahan data jika tidak ada:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $preference = App\Preference::FirstOrCreate([&#39;user_id&#39;=&gt;$user-&gt;id]);
&gt;&gt;&gt; $preference-&gt;update([&#39;country&#39;=&gt;&#39;CN&#39;, &#39;currency&#39;=&gt;&#39;CNY&#39;]);
</pre></div>
</div>
<p>atau secara logika kita dapat menggunakan method firstOrCreate dalam membuat data baru atau mengupdate data saja, tentu ini lebih praktis daripada membuat data dari awal, bisa saja data yang dibutuhkan hanya satu, jika membuat data dari awal maka bisa saja nanti datanya lebih dari satu</p>
<p>seperti misalkan</p>
<p>kita membuat aplikasi log user yaitu pencatatan user dalam melakukan login terakhir</p>
<p>misal user login lalu secara otomatis kita akan menyimpan datanya jika belum ada data log, kita akan mengisi data login_terakhir</p>
<p>lalu user yang sama login lagi maka kita akan mengupdata data login_terakhir dan bukan menambah lagi datanya.</p>
</div>
<div class="section" id="query-constraint">
<h3><a class="toc-backref" href="#id12">1.3.2&nbsp;&nbsp;&nbsp;Query Constraint</a><a class="headerlink" href="#query-constraint" title="Permalink to this headline">¶</a></h3>
<p>Ketika kita membutuhkan adanya beberapa filter dalam menyeleksi data maka dibutuhkan adanya query constraint.</p>
<p>Dalam query constraint ini akan berkutat pada method <code class="docutils literal"><span class="pre">where</span></code>.</p>
<p>Dan hampir semua method <code class="docutils literal"><span class="pre">where</span></code> dalam eloquent sama dengan query builder, seperti <code class="docutils literal"><span class="pre">whereBetween</span></code>, <code class="docutils literal"><span class="pre">whereNull</span></code>, dll:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">whereBetween</span><span class="p">(</span><span class="s1">&#39;stock&#39;</span><span class="p">,[</span><span class="mi">20</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>

<span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">whereIn</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="section" id="soft-delete">
<h3><a class="toc-backref" href="#id13">1.3.3&nbsp;&nbsp;&nbsp;Soft Delete</a><a class="headerlink" href="#soft-delete" title="Permalink to this headline">¶</a></h3>
<p>Fitur ini adalah menghapus data namun data yang terhapus tersebut dapat dikembalikan lagi suatu hari nanti(seperti fitur trash pada wordpress).</p>
<p>Untuk dapat mengimpllementasikan fitur ini maka dibutuhkan 2 hal :</p>
<p>1.menambah field <code class="docutils literal"><span class="pre">deleted_at</span></code> pada tabel dengan tipe <code class="docutils literal"><span class="pre">timestamps</span></code></p>
<p>2.Mengaktifkan trait IlluminateDatabaseEloquentSoftDeletes pada model</p>
<p>untuk yang pertama kita bisa menambahkan field dengan migration dengan syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$table-&gt;softDeletes();
</pre></div>
</div>
<p>selanjutnya kita memberikan trait di dalam class, misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php namespace App;
....
use Illuminate\Database\Eloquent\SoftDeletes;
class Product extends Model {
use SoftDeletes;
protected $dates = [&#39;deleted_at&#39;];
....
}
</pre></div>
</div>
<p>syntax <code class="docutils literal"><span class="pre">protected</span> <span class="pre">$dates</span> <span class="pre">=</span> <span class="pre">['deleted_at'];</span></code> akan membuat field <code class="docutils literal"><span class="pre">dates</span></code> menjadi tanggal dan mengkonversikan ke object <code class="docutils literal"><span class="pre">Carbon</span></code>.</p>
<p>Cara kerja soft delete pada eloquent adalah mengisikan data tanggal pada field <code class="docutils literal"><span class="pre">deleted_at</span></code> ketika melakukan method <code class="docutils literal"><span class="pre">delete()</span></code>, dan nantinya saat menggunakan query fetch(get, atau all) tidak akan menemukan data tersebut:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$product = App\Product::find(1);

$product-&gt;delete();
</pre></div>
</div>
<p>Tentu ini hanya dapat digunakan dengan eloquent, jika menggunakan query builder maka masih dapat mengakses record tersebut.</p>
<p>Untuk mendapatkan data yang dihapus maka dapat menggunakan method <code class="docutils literal"><span class="pre">withTrashed</span></code> . data yang memiliki field <code class="docutils literal"><span class="pre">deleted_at</span></code> akan dimunculkan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$product = App\Product::withTrashed()-&gt;find(1);

App\Product::withTrashed()-&gt;where(&#39;name&#39;, &#39;Accord&#39;)-&gt;get()-&gt;toArray();
</pre></div>
</div>
<p>untuk memastikan bahwa record telah dihapus dengan softdelete dapat mengugnakan method <code class="docutils literal"><span class="pre">trashed</span></code>.</p>
<p>Untuk mengembalikan record yang dihapus dengan soft delete dapat menggunakan method <code class="docutils literal"><span class="pre">restore</span></code>, dan untuk menggunakannya maka sebelumnya harus mendapatkan dahulu datanya dengan method <code class="docutils literal"><span class="pre">withTrashed</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$product = App\Product::withTrashed()-&gt;find(1);
</pre></div>
</div>
<p>untuk menghapus secara paksa record dapat menggunakan method <code class="docutils literal"><span class="pre">forceDelete()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$product-&gt;forceDelete();
</pre></div>
</div>
</div>
</div>
<div class="section" id="query-scope">
<h2><a class="toc-backref" href="#id14">1.4&nbsp;&nbsp;&nbsp;Query Scope</a><a class="headerlink" href="#query-scope" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">Query</span> <span class="pre">scope</span></code> adalah query yang kita buat dengan method tersendiri pada model, selanjutnya kita dapat memangiil method tersebut dalam melakukan query.</p>
<p>Query scope sangat dibutuhkan ketika terdapat adanya aturan dalam <code class="docutils literal"><span class="pre">business</span> <span class="pre">rule</span></code>.</p>
<p>Semisal untuk mengecek jumlah barang yang terlalu banyak(overstock) maka kita dapat menggunakan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$products = Product::where(&#39;stock&#39;, &#39;&gt;&#39;, 30)-&gt;get();
</pre></div>
</div>
<p>hanya saja kita tidak tahu pasti apakah nantinya memang barang yang overstock itu selalu dengan jumlah 30 , bisa saja berubah kan</p>
<p>selain itu kita tidak tahu pasti apakah dalam apllikasi akan membutuhkan query yang sama, jika hanya mengecek jumlah barang seerti contoh diatas memang mudah, namun bagaimana jika ada query lain yang sanagt kompleks yang membutuhkan lebih dari satu field.</p>
<p>Untuk menggunakan query scope maka kita hanya perlu menambah method ppada model dengan prefix <code class="docutils literal"><span class="pre">scope</span></code> kemudian memberikan parameter <code class="docutils literal"><span class="pre">$query</span></code>, selanjutnya di dalam statement methid tersebut dapat kita isi dengan krtieria yang dibutuhkan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>public function scopeOverstock($query)
{
  return $query-&gt;where(&#39;stock&#39;, &#39;&gt;&#39;, 30);
}
</pre></div>
</div>
<p>pada statement method , meskipun kita menggunakan query constraint namun kita tidak boleh memanggil method <code class="docutils literal"><span class="pre">get()</span></code>.</p>
<p>nantinya saat pengeksekusisan code dapat kita berikan method <code class="docutils literal"><span class="pre">get()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$products = Product::overstock()-&gt;get();
</pre></div>
</div>
<p>Query scope ini juga dapat ditambahakan dengan method where lain bahkan dengan scope lain:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">overstock</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">where</span><span class="p">(</span><span class="s1">&#39;price&#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="mi">400000000</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>

<span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">overstock</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">overprice</span><span class="p">()</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span> <span class="o">//</span><span class="n">method</span> <span class="n">overprice</span> <span class="n">sebelumnya</span> <span class="n">harud</span> <span class="n">ditulis</span> <span class="n">pada</span> <span class="n">model</span>
</pre></div>
</div>
<div class="section" id="dynamic-scope">
<h3><a class="toc-backref" href="#id15">1.4.1&nbsp;&nbsp;&nbsp;Dynamic scope</a><a class="headerlink" href="#dynamic-scope" title="Permalink to this headline">¶</a></h3>
<p>Kita juga dapat menambahkan parameter ke dalam scope, dengan adanya parameter ini maka kita dapat memberikan statement dalam mengolah query melalui parameter tersebut.</p>
<p>suatu contoh misalkan kita akan membuat scope yang akan mebedakan barang dari harganya, terdapat 3 level yang diukur dari harga barang:</p>
<p>1.**lux** -&gt; barang dengan harga lebih dari 500000000</p>
<p>2.**mid** -&gt; barang dengan harga diantara 300000000 - 500000000</p>
<p>3.**entry** -&gt; barang dengan harga dibawah 300000000</p>
<p>dan berikut adalah method yang akan kita berikan:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>public function scopeLevel($query, $parameter)
{
  switch ($parameter) {
    case &#39;lux&#39;:
      return $query-&gt;where(&#39;price&#39;, &#39;&gt;&#39;, 500000000);
    break;
    case &#39;mid&#39;:
      return $query-&gt;whereBetween(&#39;price&#39;, [300000000,500000000]);
    break;
    case &#39;entry&#39;:
      return $query-&gt;where(&#39;price&#39;, &#39;&lt;&#39;, 300000000);
    break;
    default:
      return $query;
    break;
  }
}
</pre></div>
</div>
<p>untuk menggunakan query scope diatas maka kita akan mempassing satu parameter dalam menjalankan method level():</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">level</span><span class="p">(</span><span class="s1">&#39;lux&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>

<span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">level</span><span class="p">(</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>

<span class="n">App</span>\<span class="n">Product</span><span class="p">::</span><span class="n">level</span><span class="p">(</span><span class="s1">&#39;entry&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">get</span><span class="p">();</span>
</pre></div>
</div>
<p>dan jika semisal kita memberikan parameter yang salah (tidak terdapat pada case) maka semua data akan ditampilkan</p>
</div>
<div class="section" id="global-scope">
<h3><a class="toc-backref" href="#id16">1.4.2&nbsp;&nbsp;&nbsp;Global Scope</a><a class="headerlink" href="#global-scope" title="Permalink to this headline">¶</a></h3>
<p>Scope dapat juga dibuat global sehingga dapat diakses pada model manapun.</p>
<p>dalam global scope terdapat 2 cara dalam mengimplementasikannya yaitu dengan</p>
<p>1.Manual =&gt; dengan membuat file trait scope yang berisi method, nantinya method ini akan disertakan di dalam model (di dalam class model)</p>
<p>2.Otomatis =&gt; dengan membuat class yang me-implement interface ‘scopeInterface’ ,kemudian membuat 2 method, yaitu apply(jika quwery ketemu) dan remove(jika query gak ketemu), selanjutnyakita akan membuat file trait dan memasukkan scope pada class tersebut , selanjutnya kita akan memasukkan pada model.</p>
<p>Pada cara 1 jauh lebih mudah karena kita hanya perlu menambahkan method yang akan digunakan dalam menjalankan query, dan kesemuanya akan menggunakan query eloquent secara standard.</p>
<p>Sedangkan cara 2 jauh lebih sulit karaena pada intinya kita memodifikasi query eloquent itu sendiri sehingga diperlukan adanya ketelitian dalam menuliskan kriteria yang akan digunakan.</p>
<p>jika menggunakan cara kedua maka satu-satunya jalan untuk menggunakan query eloquent secara standar adalah dengan menggunakan method remove, di dalam method remove ini sendiri kita perlu memasukkan statement yang berisikan kriteria secara normal(jika dalam method apply akan mencari dengan data pada field tertentu, maka pada method remove harus menghilangkannya).</p>
<p>Dan cara tersebut tidaklah mudah dikarenakan kita harus mengoprek query eloquent(misalkan menghapus adanya key where).</p>
<p>untuk menjalankan metod remove ini kita akan menggunakan method <code class="docutils literal"><span class="pre">newQueryWithoutScopes()</span></code>.</p>
<p>Dan untuk lebih memudahkan kita dapat membuat method custom(yang diawali dengan prefix <code class="docutils literal"><span class="pre">with</span></code>) yang akan menggunakan method <code class="docutils literal"><span class="pre">newQueryWithoutScopes()</span></code> di dalamnya sehingga saat ingin menggunakan query eloquent yang standard dapat menggunakan mehtod custom tersebut</p>
<p>Pada fitur softdelete sebenarnya mengimmplemetasikan fitur query global scope seperti ini.</p>
</div>
</div>
<div class="section" id="accessor-dan-mutator">
<h2><a class="toc-backref" href="#id17">1.5&nbsp;&nbsp;&nbsp;Accessor dan Mutator</a><a class="headerlink" href="#accessor-dan-mutator" title="Permalink to this headline">¶</a></h2>
<p>Secara singkat saja , accessor dan mutator ini adalah mehtod yang digunakan untuk memodifikasi data ketika akan disimpan di dalam database dan ketika akan diambil(dioutputkan) dari model.</p>
<p>Singkatnya adalah acessor =&gt; get sedangkan mutator =&gt; set, dan dari kedua hal ini kita dapat memodifikasi data ketika akan disimpa dalam database atau ketika akan diambil dari model.</p>
<p>Contoh Penggunaannya adalah:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Hanya</span> <span class="n">Mutator</span><span class="o">**</span> <span class="p">:</span> <span class="n">semisal</span> <span class="n">kita</span> <span class="n">akan</span> <span class="n">merubah</span> <span class="n">field</span> <span class="n">password</span> <span class="n">dengan</span> <span class="s1">&#39;hash&#39;</span> <span class="n">sebelum</span> <span class="n">disimpan</span> <span class="n">dalam</span> <span class="n">database</span><span class="p">,</span> <span class="n">kita</span> <span class="n">akan</span> <span class="n">menge</span><span class="o">-</span><span class="nb">set</span> <span class="n">value</span> <span class="n">pada</span> <span class="n">password</span>

<span class="o">**</span><span class="n">Hanya</span> <span class="n">Accessor</span><span class="o">**</span> <span class="p">:</span> <span class="n">semisal</span> <span class="n">kita</span> <span class="n">akan</span> <span class="n">menggabungkan</span> <span class="n">field</span> <span class="n">firstname</span> <span class="n">dan</span> <span class="n">lastname</span> <span class="n">ke</span> <span class="n">dalam</span> <span class="n">fullname</span><span class="p">(</span><span class="n">fullname</span> <span class="n">ini</span> <span class="n">sebenarnya</span> <span class="n">tidak</span> <span class="n">ada</span> <span class="n">di</span> <span class="n">tabel</span><span class="p">,</span> <span class="n">namun</span> <span class="n">tidak</span> <span class="n">perlu</span> <span class="n">diisi</span> <span class="n">ketika</span> <span class="n">user</span> <span class="n">mengisikan</span> <span class="n">form</span> <span class="n">formulir</span><span class="p">,</span> <span class="n">namun</span> <span class="n">kita</span> <span class="n">akan</span> <span class="n">membuatnya</span> <span class="n">menjadi</span> <span class="n">attribut</span> <span class="n">di</span> <span class="n">dalam</span> <span class="n">model</span><span class="p">,</span> <span class="n">yang</span> <span class="n">mana</span> <span class="n">seperti</span> <span class="n">field</span><span class="o">/</span><span class="n">kolom</span> <span class="n">pada</span> <span class="n">tabel</span><span class="p">),</span> <span class="n">artinya</span> <span class="n">kita</span> <span class="n">hanya</span> <span class="n">mendapatkan</span> <span class="n">field</span> <span class="n">lain</span> <span class="n">dan</span> <span class="n">memasukkannya</span> <span class="n">pada</span> <span class="n">attribut</span><span class="o">/</span><span class="nb">property</span><span class="p">(</span><span class="n">field</span> <span class="n">pada</span> <span class="n">model</span><span class="p">)</span><span class="o">.</span>

<span class="o">**</span><span class="n">Hanya</span> <span class="n">accessor</span> <span class="n">dan</span> <span class="n">mutator</span><span class="o">**</span> <span class="p">:</span> <span class="n">semisal</span> <span class="n">kita</span> <span class="n">ingin</span> <span class="n">merubah</span> <span class="nb">format</span> <span class="n">ketika</span> <span class="n">akan</span> <span class="n">mengisikan</span> <span class="n">field</span> <span class="n">tanggal</span> <span class="n">dengan</span> <span class="nb">format</span> <span class="n">DD</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">YYYY</span><span class="p">,</span> <span class="n">namun</span> <span class="n">ketika</span> <span class="n">akan</span> <span class="n">disimpan</span> <span class="n">ke</span> <span class="n">dalam</span> <span class="n">database</span> <span class="n">diubah</span> <span class="n">lagi</span> <span class="n">menjadi</span> <span class="n">YYYY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD</span><span class="p">,</span> <span class="n">kemudian</span> <span class="n">ketika</span> <span class="n">akan</span> <span class="n">mengambil</span> <span class="n">data</span> <span class="n">dari</span> <span class="n">model</span> <span class="n">menggunakan</span> <span class="nb">format</span> <span class="n">DD</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">YYYY</span><span class="p">,</span> <span class="n">hal</span> <span class="n">ini</span> <span class="n">tentu</span> <span class="n">untuk</span> <span class="n">mempermudah</span> <span class="n">user</span><span class="o">.</span>
</pre></div>
</div>
<p>Sebelum melakukan pengaplikasian ini, sebelumnya buatlah tabel profiles dengan struktur berikut pada migrasi</p>
<p>file migrasi <strong>buat_tabel_profiles</strong></p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Illuminate\Database\Schema\Blueprint</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Migrations\Migration</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">BuatTabelProfiles</span> <span class="k">extends</span> <span class="nx">Migration</span>
<span class="p">{</span>
  <span class="sd">/**</span>
<span class="sd">  * Run the migrations.</span>
<span class="sd">  *</span>
<span class="sd">  * @return void</span>
<span class="sd">  */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">up</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nx">Schema</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Blueprint</span> <span class="nv">$table</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">increments</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;firstname&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;lastname&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">date</span><span class="p">(</span><span class="s1">&#39;tanggal_lahir&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">timestamps</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">  * Reverse the migrations.</span>
<span class="sd">  *</span>
<span class="sd">  * @return void</span>
<span class="sd">  */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">down</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nx">Schema</span><span class="o">::</span><span class="na">drop</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="section" id="mutator">
<h3><a class="toc-backref" href="#id18">1.5.1&nbsp;&nbsp;&nbsp;<strong>Mutator</strong></a><a class="headerlink" href="#mutator" title="Permalink to this headline">¶</a></h3>
<p>Dalam mutator kita akan mengubah attribut pada model sebelum disimpan ke dalam database, artinya sebelumnya attribut ini sudah diisi terlebih dahulu, kemudian isi/value tersebut akan kita ubah baru kemudian akan dimasukkan ke dalam database.</p>
<p>Penggunaan ini misalkan kita akan mengubah field password dengan memberikan fungsi <code class="docutils literal"><span class="pre">hash</span></code> sebelum disimpan ke dalam database.</p>
<p>Dalam laravel terdapat method dalam melakukan hashing ini, yaitu dengan <code class="docutils literal"><span class="pre">Hash::make()</span></code>, parameternya adalah script string yang akan diubah.</p>
<p>Sebagai catatan kita juga dapat melakukannya dengan method <code class="docutils literal"><span class="pre">bcrypt()</span></code> , nantinya output yang dihasilkan dengan <code class="docutils literal"><span class="pre">Hash::make()</span></code> atau <code class="docutils literal"><span class="pre">bcrypt()</span></code> ini akan diubah dengan metode satu arah, artinya ketika kita akan melakukan pada sring yang sama maka hasilnya akan berbeda, namun ketika dicek antara dengan string dengan hasil bcrypt dtring tersebut hasilnya akan true.</p>
<p>Untuk menggunakan mutator maka kita harus membuat method baru dalam model dengan format nama <code class="docutils literal"><span class="pre">setNamaatrributeAttribute(parameter)</span></code>, misalkan jika kita akan membuat mutator pada password maka nama method nya adalah <code class="docutils literal"><span class="pre">setPasswordAttribute($password)</span></code> .</p>
<p>Selanjutnya method tersebut akan dijalankan ketika terdapat adanya set daripada attribute password.</p>
<img alt="_images/8.1.2.mutator2.jpg" src="_images/8.1.2.mutator2.jpg" />
<img alt="_images/8.1.1.mutator.jpg" src="_images/8.1.1.mutator.jpg" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Parameter di dalam method mutator ini tidak perlu sama dengan nama attribute pada field, misalkan $password diatas bisa kita ubah menjadi $pass saja.</p>
</div>
<img alt="_images/8.1.3.mutator3.jpg" src="_images/8.1.3.mutator3.jpg" />
<img alt="_images/8.1.4.mutator4.jpg" src="_images/8.1.4.mutator4.jpg" />
</div>
<div class="section" id="accessor">
<h3><a class="toc-backref" href="#id19">1.5.2&nbsp;&nbsp;&nbsp;Accessor</a><a class="headerlink" href="#accessor" title="Permalink to this headline">¶</a></h3>
<img alt="_images/8.1.6.mutator6.jpg" src="_images/8.1.6.mutator6.jpg" />
<img alt="_images/8.1.5.mutator5.jpg" src="_images/8.1.5.mutator5.jpg" />
<p>untuk menampilkan attribute fullname diatas harus memberikan $appends berupa array dengan value string attribute tersebut</p>
<img alt="_images/8.1.7.mutator7.jpg" src="_images/8.1.7.mutator7.jpg" />
<img alt="_images/8.1.8.mutator8.jpg" src="_images/8.1.8.mutator8.jpg" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Kita juga dapat memanfaatkan accessor ini dalam menyimpan ke dalam database dengan memanfaatkan attribute lain.</p>
<p>Dalam contoh diatas kita hanya membuat attribute baru dan menyimpannya ke dalam model namun tidak menyimpannya ke dalam database,</p>
<p>berikut cara dalam mendapatkan attribute lain untuk selanjutnya disimpan ke dalam database</p>
<img alt="_images/8.1.9.mutator9.jpg" src="_images/8.1.9.mutator9.jpg" />
<img alt="_images/8.1.10.mutator10.jpg" class="last" src="_images/8.1.10.mutator10.jpg" />
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>mengenal lebih jauh tentang accessor dan mutator</strong></p>
<p>Accessor dan mutator sebenarnya akan diakses berdasarkan daripada metode pengaksesan, yaitu apakah itu get atau set.</p>
<p>Accessor akan dijalankan jika attribute sedang menjalani get, atau sedang menge-get attribute,</p>
<p>Mutator akan dijalankan jika attribute sedang menjalani set, atau sedang menge-set attribute (memberikan value).</p>
<p>Sedangkan model(eloquent) memiliki implementasi yang berbeda dengan database, berikut penjelasan secara rinci</p>
<p>semisal kita akan membuat accessor dan mutator dalam attribute yang sama, dan tentunya attribute ini ada dalam field database, sehingga nantinya dapat diakses di database dan di dalam model(dengan mengakses attribute tersebut)</p>
<p>misalkan kita akan membuat migrasi seperti berikut</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="k">use</span> <span class="nx">Illuminate\Database\Schema\Blueprint</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Illuminate\Database\Migrations\Migration</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">BuatTabelProfiles</span> <span class="k">extends</span> <span class="nx">Migration</span>
<span class="p">{</span>
  <span class="sd">/**</span>
<span class="sd">  * Run the migrations.</span>
<span class="sd">  *</span>
<span class="sd">  * @return void</span>
<span class="sd">  */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">up</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nx">Schema</span><span class="o">::</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">,</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Blueprint</span> <span class="nv">$table</span><span class="p">)</span> <span class="p">{</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">increments</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;firstname&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;lastname&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;fullname&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;email&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">string</span><span class="p">(</span><span class="s1">&#39;password&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">date</span><span class="p">(</span><span class="s1">&#39;tanggal_lahir&#39;</span><span class="p">);</span>
      <span class="nv">$table</span><span class="o">-&gt;</span><span class="na">timestamps</span><span class="p">();</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="sd">/**</span>
<span class="sd">  * Reverse the migrations.</span>
<span class="sd">  *</span>
<span class="sd">  * @return void</span>
<span class="sd">  */</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">down</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="nx">Schema</span><span class="o">::</span><span class="na">drop</span><span class="p">(</span><span class="s1">&#39;profiles&#39;</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Contoh model terlihat bahwa kita memberikan accessor(get) dan mutator (set) pada attribute yang sama</p>
<div class="highlight-php"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="k">namespace</span> <span class="nx">App</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Illuminate\Database\Eloquent\Model</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Profile</span> <span class="k">extends</span> <span class="nx">Model</span>
<span class="p">{</span>
  <span class="k">public</span> <span class="k">function</span> <span class="nf">getFullnameAttribute</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">attributes</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">firstname</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">public</span> <span class="k">function</span> <span class="nf">setFullnameAttribute</span><span class="p">()</span>
  <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">attributes</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span><span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">lastname</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>pertama kita akan menggunakan accessor</p>
<p>pada attribute fullname hanya kita get saja</p>
<p>hasilnya di dalam model, attribute fullname adalah value yang sama dengan attribute firstname</p>
<img alt="_images/8.1.11.mutator11.jpg" src="_images/8.1.11.mutator11.jpg" />
<p>kemudian kita mengisi data selanjutnya</p>
<p>pada data ini kita mengese attribute fullname,</p>
<p>maka kita mengakses mutator attribute fullname ini</p>
<p>namun saat dilihat attributeny dengan model , attribute fullname ini sama dengan value attribute firstname</p>
<p>benarkah kita mengakses mutatornya ??</p>
<img alt="_images/8.1.12.mutator12.jpg" src="_images/8.1.12.mutator12.jpg" />
<p>namun ketika melihat di database ternyata datanya berbeda</p>
<p>data pertama pada field fullname sama dengan field firstname</p>
<p>sedangkan data kedua pada field fullname sama dengan field lastname</p>
<p>ini artinya ketika kita menge-get attribute kita emnjalankan accessor</p>
<p>dan ketika ketika kita menge-set attribute kita menjalankan mutator</p>
<img alt="_images/8.1.13.mutator13.jpg" src="_images/8.1.13.mutator13.jpg" />
<p>kemudian bagaimana bisa saat menampilkan data pada eloquent hasilnya berbeda</p>
<p>ini dikarenakan pada model eloquent itu sendiri, yaitu tentang object yang akan ditampilkan menurut dengan methodnnya</p>
<p>misalkan jika kita menggunakan method find maka laravel akan me fetch data pada tabel profile, dan akan merubah field tabel menjadi attribute model</p>
<p>namun ketika kita akan menge-get fullname, maka kita akan mengakses accessornya, dalam hal ini datanya sudah tidak murni karena kita menjalankan method getFullnameAttribute</p>
<img alt="_images/8.1.14.mutator14.jpg" class="last" src="_images/8.1.14.mutator14.jpg" />
</div>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id20">1.5.3&nbsp;&nbsp;&nbsp;Accessor dan mutator</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Ini adalah penggabungan dari keduanya, sebenarnya ini sudah dijelaskan dasar nya pada catatan diatas, namun belum diimplementasikan kepada aplikasi secara benar.</p>
<p>Penggunaan accessor dan mutator dalam attribute yang sama adalah semisal pada penggunaan tanggal(date).</p>
<p>Seperti diketahui bahwa format standar pada tipe data date adalah <code class="docutils literal"><span class="pre">YYYY-MM-DD</span></code> misal <code class="docutils literal"><span class="pre">2016-06-09</span></code>.</p>
<p>bagaimana jika yang diiunput user tidak sesuai dengan format date pada database, bisa saja saat menginput menggunakan format yang lain yang lebih mudah semisal <code class="docutils literal"><span class="pre">DD/MM/YYYY</span></code> atau dengan format lain yang agak berbeda seperti <code class="docutils literal"><span class="pre">MM/DD/YYYY</span></code></p>
<p>tentu ini membutuhkan adanya accessor dan mutator, apalagi ketika data nya akan dioutputkan dari model, dan jika output nya memiliki format yang sama tentu akan sangat tidak keren.</p>
<p>jika kita menyimpan selain dalam format YYYY-MM-DD maka akan gagal</p>
<img alt="_images/8.1.15.mutator15.jpg" src="_images/8.1.15.mutator15.jpg" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Sebenarnya dalam melakukan contoh in akan lebih mudah jika terdapat adanya library Carbon.</p>
<p>Library carbon dapat merubah format dalam apapun yang dibtutuhkan.</p>
<p>namun karena tidak ada buat pengandaian saja.</p>
<p>Contoh:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>public function setBirthDateAttribute($date)
{
  $this-&gt;attributes[&#39;birth_date&#39;] = \Carbon\Carbon::createFromFormat(&#39;d/m/Y&#39;, $date)-&gt;toDateString();
}
public function getBirthDateAttribute($date)
{
  return \Carbon\Carbon::createFromFormat(&#39;Y-m-d&#39;, $date)-&gt;format(&#39;d/m/Y&#39;);
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="event-dan-model-observer">
<h2><a class="toc-backref" href="#id21">1.6&nbsp;&nbsp;&nbsp;Event dan Model Observer</a><a class="headerlink" href="#event-dan-model-observer" title="Permalink to this headline">¶</a></h2>
<p>Apa itu <strong>hook</strong> ???</p>
<p>pernahkah kita membaca syntax dengan hook, apakah kita tahu apa itu kegunaan hook ???</p>
<p>Hook secara singkat adalah event yang dapat diisi/dijalankan pada syntax utama.</p>
<p>artinya hook ini bukanlah syntax utama namun hanya syntax pendamping yang dijalankan untuk memproses beberapa hal tertentu.</p>
<p>Dalam eloquent kita dapat memberikan event(hook) pada proses CRUD.</p>
<p>berikut adalah event yang dapat di gunakan dalam eloquent:</p>
<ol class="arabic simple">
<li>hook pada proses <strong>create</strong> (pada bagian data yang akan disimpan atau tidak pada setiap data yang akan disimpan)</li>
</ol>
<blockquote>
<div>creating : Dijalankan ketika ketika kita hendak menyimpan model ke database pertama kali (record baru). Event ini akan dijalankan sebelum model di simpan ke database.
created : Hampir sama dengan creating. Perbedaannya event ini dijalankan setelah model disimpan ke database.</div></blockquote>
<ol class="arabic simple" start="2">
<li>hook pada proses update(pada setiap data yang diedit)</li>
</ol>
<blockquote>
<div>updating : Dijalankan ketika ketika kita hendak menyimpan model yang telah kita ubah datanya (update). Event ini akan dijalankan sebelum model di simpan ke database.
updated : Hampir sama dengan updating. Perbedaannya event ini dijalankan setelah model disimpan ke database.</div></blockquote>
<ol class="arabic simple" start="3">
<li>hook pada proses <strong>save</strong> (pada setiap data yang akan disimpan)</li>
</ol>
<blockquote>
<div>saving : Akan dijalankan ketika kita hendak menyimpan model. Event ini akan selalu dijalankan tanpa mengecek apakah model tersebut merupakan record baru atau bukan. Event ini akan dijalankan sebelum model di simpan ke database.
saved : Hampir sama dengan saving. Perbedaannya event ini dijalankan setelah model disimpan ke database.</div></blockquote>
<ol class="arabic simple" start="4">
<li>hook pada proses <strong>delete</strong> (pada setiap data yang dihapus)</li>
</ol>
<blockquote>
<div>deleting : Dijalankan ketika ketika kita hendak menghapus model. Event ini akan dijalankan sebelum model dihapus.
deleted : Hampir sama dengan saved. Perbedaannya event ini dijalankan setelah model dihapus.</div></blockquote>
<ol class="arabic simple" start="5">
<li><strong>restore</strong> (pada data yang akan dikembalikan dari soft delete)</li>
</ol>
<blockquote>
<div>restoring : Dijalankan ketika ketika kita hendak mengembalikan model yang sudah dihapus, dimana model tersebut mengaktifkan soft delete. Event ini akan dijalankan sebelum model dikembalikan.
restored : Hampir sama dengan restoring. Perbedaannya event ini dijalankan setelah model dikembalikan.</div></blockquote>
<p>Dalam melakukan event tersebut kita dapat memberikannya pada method boot baik pada model atau service provider tertentu.</p>
<p>Semuanya menggunakan method ,seperti misal <code class="docutils literal"><span class="pre">created()</span></code>,``creating``,``updating``,``saved``,``deleteing`` dll.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><strong>apa fungsi hook dalam eloquent secara eksplisit/jelas</strong></p>
<p>Dalam penggunaan sederhana kita dapar menyimpan log pada setiap proses CRUD, yang mana log ini tidak perlu disimpan ke dalam database.</p>
<p>Seperti diketahui bahwa log adalah catatan mengenai perubahan yang terjadi pada suatu sistem, dan tentu log ini bisa saja tidak menyangkut pada data yang digunakan.’</p>
<p>misal kan pengiriman kayu ke suatu gudang, maka catatan utamanya adalah mencatat tentang kayunya, seperti jenis, jumlah dll.</p>
<p>Apakah mungkin si pencatat ini mencatat jenis ban truk yang digunakan untuk mengangkut ke dalam database??? buat apa ??</p>
<p>tapi si pencatat ini hanya ingin memastikan saja jenis ban mana yang baik untuk mengangkut kayu.</p>
<p>nah ini seaiknya dicatat di log, , yang artinya log bukanlah hal utama sumber pembuat data, tetapi log adalah catatan dalam pemberian keterangan.</p>
<p>Seperti seorang supir harus dicatat log nya (seperti jam makan, istirahat dll), namun tentu catatan itu tidak perlu masuk ke dalam database aplikasi pengiriman kayu.</p>
<p>tentunya hook yang dilakukan settelah perintah utama selesai adalah untuk laporan</p>
<p>lantas untuk apa hook sebelum petintah utama ???</p>
<p>well, dalam eloquent kita dapat membatalkan proses CRUD apabila hook ini bernilai false</p>
<p>misalkan ketika terdapat adanya relasi tabel maka ketika kita mengubah setia field dari tabel berelasi akan membuat adanya perbedaan data(pada field/kolom tersebu)</p>
<p>misalkan kita memiliki tabel barangs dan orders_barangs</p>
<p>nah ternyata kita telah memiliki data barangs dan orders_barangs yang berelasi</p>
<p>kemudian bagaimana jika kita mengubah data nama barang , padahal data tersebut berelasi dengan orders_product,</p>
<p>tentu jika sudah ada reporting sebelumnya yang belum berubah nama barang nya akan menjadi masalah(meski kecil)</p>
<p>nah kita dapat membatalkan peintah update nama barang ini</p>
<p>misal kalau data barangs sudah berelasi di data orders_products, maka data pada barangs tidak dapat diubah seperti nama_barang</p>
<p>dan akan memunculkan error data tidak dapat diubah karena memiliki relasi</p>
<p>well tentu contoh tersebut masih belum cukup relevan pada aplikasi order., namun ini hanya penggambaran saja.</p>
<p>Penggunaan secara eksplisit event dan observer
Pada suatu aplikasi tentu akan dibutuhkan adanya beberapa tabel, dan tabel-tabel tersebut bisa saja memiliki adanya relasi.</p>
<p>Ketika suatu data memiliki adanya keterikatan (dari relasi dengan tabel lain), maka ketika terjadi manipulasi seperti update atau delete akan terjadi error.</p>
<p>Kenapa ???</p>
<p>karena tabel yang berelasi biasanya terdapat unsur tabel pemilik tabel lain dan tabel yang dimiliki tabel lain.</p>
<p>baik dari kedua tabel tersebut tentu akan kesulitan dalam melakukan update dan delete.</p>
<p>Nah maka dari itu dibutuhkan adanya hook yang melepas ikatan relasi tersebut</p>
<p>Tetepi sebelumnya harus didefinisikan adanya tabel pemilik dan tabel yang dimiliki.</p>
<p class="last">Nantinya kita baru akan membuat penghilang relasi dengan hook pada sebelum CRUD, seperti creating , saving, updating, deleting.</p>
</div>
</div>
<div class="section" id="penggunaan-property-dan-method-pada-data-dari-relasi-model">
<h2><a class="toc-backref" href="#id22">1.7&nbsp;&nbsp;&nbsp;Penggunaan property dan method pada data dari relasi model</a><a class="headerlink" href="#penggunaan-property-dan-method-pada-data-dari-relasi-model" title="Permalink to this headline">¶</a></h2>
<p>dalam menggunakan data yang berelasi pada eloquent, maka peran dalam property dan method sangatlah penting</p>
<p>jika mengambil data pada tabel yang berelasi lebih dari satu maka jaangan menggunkana method, namun gunakan property:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">App</span>\<span class="n">NameModel</span><span class="p">::</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">RelationTable1</span><span class="o">-&gt;</span><span class="n">RelationTable2</span><span class="o">-&gt;</span><span class="n">RelationTableN</span><span class="p">;</span>
</pre></div>
</div>
<p>jika kita mengambil satu data pada field tertentu maka dibutuhkan adanya method pluck, namun dengan property maka dengan mudah kita dapat mengambil data dengna menyertakan nama fieldnya</p>
<p>misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&gt;&gt;&gt; $app = App\Vehicle::find(1);
=&gt; App\Vehicle {#946
     id: 1,
     no_plat: &quot;AB 101 BA&quot;,
     panjang: 2,
     lebar: 2,
     tinggi: 3,
     beban_max: 2000,
     merek: &quot;Diesel&quot;,
     tahun_pembuatan: 2010,
     imgpath: &quot;/images/vehicles/20160419084512.vehicle-wrap1.jpg&quot;,
     active: 1,
     provider_id: 1,
     created_at: &quot;2016-04-19 08:45:12&quot;,
     updated_at: &quot;2016-04-19 08:46:22&quot;,
     vcategories_id: 1,
     warna_plat: &quot;&quot;,
     kelas_jalan_terendah: &quot;&quot;,
     masa_berlaku_stnk: &quot;0000-00-00&quot;,
     masa_berlaku_uji_berkala: &quot;0000-00-00&quot;,
     name: &quot;Kendaraan Truck&quot;,
   }

&gt;&gt;&gt; $app-&gt;provider();
=&gt; Illuminate\Database\Eloquent\Relations\BelongsTo {#975}

&gt;&gt;&gt; $app-&gt;provider()-&gt;user();
BadMethodCallException with message &#39;Call to undefined method Illuminate\Database\Query\Builder::user()&#39;

&gt;&gt;&gt; $app-&gt;provider-&gt;user;
=&gt; App\User {#957
     id: 8,
     name: &quot;provider perseorangan satu&quot;,
     email: &quot;prov_p_satu@mail.com&quot;,
     user_role: &quot;&quot;,
     userable_id: 1,
     userable_type: &quot;App\Provider&quot;,
     created_at: &quot;2016-04-19 07:36:31&quot;,
     updated_at: &quot;2016-09-26 06:22:34&quot;,
     pp_path: &quot;/images/users/20160427025620.twitter_round.png&quot;,
   }

&gt;&gt;&gt; $app-&gt;provider-&gt;user-&gt;name;
=&gt; &quot;provider perseorangan satu&quot;
</pre></div>
</div>
</div>
<div class="section" id="has-dan-wherehas">
<h2><a class="toc-backref" href="#id23">1.8&nbsp;&nbsp;&nbsp;has dan whereHas</a><a class="headerlink" href="#has-dan-wherehas" title="Permalink to this headline">¶</a></h2>
<p>hal yang sama dari has dan whereHas adalah keduanya tidak memuat data relasi, hanya menampilkan data yang memiliki relasi dengan tabel relasinya</p>
<p>misalkan kita memiliki tabel artist dan albums dengan data</p>
<p><code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">`artists`</span></code></p>
<p>result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">id</span>  <span class="n">name</span>        <span class="n">created_at</span>          <span class="n">updated_at</span>
<span class="mi">1</span>   <span class="n">ari</span> <span class="n">lasso</span>   <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">27</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">27</span>
<span class="mi">2</span>   <span class="n">peterpan</span>    <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">34</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">34</span>
<span class="mi">3</span>   <span class="n">dewa19</span>      <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">44</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">51</span><span class="p">:</span><span class="mi">44</span>
<span class="mi">4</span>   <span class="n">ello</span>        <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">37</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">52</span><span class="p">:</span><span class="mi">37</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">SELECT</span> <span class="pre">*</span> <span class="pre">FROM</span> <span class="pre">`albums`</span></code></p>
<p>result:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">id</span>  <span class="n">name</span>                <span class="n">tahun</span>   <span class="n">id_artist</span>       <span class="n">created_at</span>          <span class="n">updated_at</span>
<span class="mi">1</span>   <span class="n">bintang</span> <span class="n">di</span> <span class="n">surga</span>    <span class="mi">2008</span>    <span class="mi">2</span>               <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">54</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">56</span>
<span class="mi">2</span>   <span class="n">alexandria</span>          <span class="mi">2007</span>    <span class="mi">2</span>               <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">17</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">03</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">17</span>
<span class="mi">3</span>   <span class="n">elang</span>               <span class="mi">2005</span>    <span class="mi">3</span>               <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">58</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mi">58</span>
<span class="mi">4</span>   <span class="n">masih</span> <span class="n">ada</span>           <span class="mi">2008</span>    <span class="mi">4</span>               <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">12</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">12</span><span class="o">-</span><span class="mi">12</span> <span class="mi">07</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">12</span>
</pre></div>
</div>
<div class="section" id="has">
<h3><a class="toc-backref" href="#id24">1.8.1&nbsp;&nbsp;&nbsp;has</a><a class="headerlink" href="#has" title="Permalink to this headline">¶</a></h3>
<p>dengan method has, maka data pada tabel utama <code class="docutils literal"><span class="pre">$app</span> <span class="pre">=</span> <span class="pre">Artist::has('albums')-&gt;get();</span></code></p>
<p>misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>dd($app);

Collection {#155 ▼
  #items: array:3 [▼
    0 =&gt; Artist {#151 ▼
      #fillable: array:1 [▶]
      #connection: null
      #table: null
      #primaryKey: &quot;id&quot;
      #perPage: 15
      +incrementing: true
      +timestamps: true
      #attributes: array:4 [▶]
      #original: array:4 [▶]
      #relations: []
      #hidden: []
      #visible: []
      #appends: []
      #guarded: array:1 [▶]
      #dates: []
      #dateFormat: null
      #casts: []
      #touches: []
      #observables: []
      #with: []
      #morphClass: null
      +exists: true
      +wasRecentlyCreated: false
    }
    1 =&gt; Artist {#153 ▼
      #fillable: array:1 [▶]
      #connection: null
      #table: null
      #primaryKey: &quot;id&quot;
      #perPage: 15
      +incrementing: true
      +timestamps: true
      #attributes: array:4 [▶]
      #original: array:4 [▶]
      #relations: []
      #hidden: []
      #visible: []
      #appends: []
      #guarded: array:1 [▶]
      #dates: []
      #dateFormat: null
      #casts: []
      #touches: []
      #observables: []
      #with: []
      #morphClass: null
      +exists: true
      +wasRecentlyCreated: false
    }
    2 =&gt; Artist {#152 ▼
      #fillable: array:1 [▶]
      #connection: null
      #table: null
      #primaryKey: &quot;id&quot;
      #perPage: 15
      +incrementing: true
      +timestamps: true
      #attributes: array:4 [▶]
      #original: array:4 [▶]
      #relations: []
      #hidden: []
      #visible: []
      #appends: []
      #guarded: array:1 [▶]
      #dates: []
      #dateFormat: null
      #casts: []
      #touches: []
      #observables: []
      #with: []
      #morphClass: null
      +exists: true
      +wasRecentlyCreated: false
    }
  ]
}
</pre></div>
</div>
<p>has tidak dapat dimodifikasi dengan menambahkan where</p>
<p>misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$app = Artist::has([&#39;albums&#39; =&gt; function ($q) { $q-&gt;where(&#39;tahun&#39;,&#39;=&#39;,&#39;2008&#39;); }])-&gt;get();
</pre></div>
</div>
<p>hasilnya akan error, untuk menambahkan addanya kondisi where maka gunakan method whereHas</p>
<div class="section" id="where-has">
<h4><a class="toc-backref" href="#id25">1.8.1.1&nbsp;&nbsp;&nbsp;where has</a><a class="headerlink" href="#where-has" title="Permalink to this headline">¶</a></h4>
<p>data yang dimunculkan adalah data yang ada di dalam relasi namun pada parameter 2 harus dipassing dengan closure where</p>
<p>misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$app = Artist::whereHas(&#39;albums&#39; , function ($q) { $q-&gt;where(&#39;tahun&#39;,&#39;=&#39;,&#39;2008&#39;); })-&gt;get();
dd($app);


Collection {#150 ▼
  #items: array:2 [▼
    0 =&gt; Artist {#157 ▼
      #fillable: array:1 [▶]
      #connection: null
      #table: null
      #primaryKey: &quot;id&quot;
      #perPage: 15
      +incrementing: true
      +timestamps: true
      #attributes: array:4 [▶]
      #original: array:4 [▶]
      #relations: []
      #hidden: []
      #visible: []
      #appends: []
      #guarded: array:1 [▶]
      #dates: []
      #dateFormat: null
      #casts: []
      #touches: []
      #observables: []
      #with: []
      #morphClass: null
      +exists: true
      +wasRecentlyCreated: false
    }
    1 =&gt; Artist {#156 ▼
      #fillable: array:1 [▶]
      #connection: null
      #table: null
      #primaryKey: &quot;id&quot;
      #perPage: 15
      +incrementing: true
      +timestamps: true
      #attributes: array:4 [▶]
      #original: array:4 [▶]
      #relations: []
      #hidden: []
      #visible: []
      #appends: []
      #guarded: array:1 [▶]
      #dates: []
      #dateFormat: null
      #casts: []
      #touches: []
      #observables: []
      #with: []
      #morphClass: null
      +exists: true
      +wasRecentlyCreated: false
    }
  ]
}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="hasmanythrough">
<h2><a class="toc-backref" href="#id26">1.9&nbsp;&nbsp;&nbsp;HasManyThrough</a><a class="headerlink" href="#hasmanythrough" title="Permalink to this headline">¶</a></h2>
<p>relasi pada tabel dapat terjadi pada 3 tabel sekaligus</p>
<p>semisal
tabel <code class="docutils literal"><span class="pre">artist</span></code>, tabel <code class="docutils literal"><span class="pre">albums</span></code> , tabel <code class="docutils literal"><span class="pre">songs</span></code></p>
<p>artists dapat memiliki albums, albums dapat memiliki songs</p>
<p>so ,intinya artist akan memiliki songs, tetapi melalui albums</p>
<p>maka artinya artist akan dideklarasikan sebagai hasmanythrough</p>
<p>misal:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>class Artist extends Model {
    protected $fillable = [&#39;name&#39;, &#39;genre&#39;];
    public function albums()
    {
        return $this-&gt;hasMany(&#39;App\Album&#39;);
    }
    public function songs()
    {
        return $this-&gt;hasManyThrough(&#39;App\Song&#39;, &#39;App\Album&#39;);
    }
}


class Album extends Model {
    protected $fillable = [&#39;artist_id&#39;, &#39;title&#39;, &#39;released&#39;];
    public function artist()
    {
        return $this-&gt;belongsTo(&#39;App\Artist&#39;);
    }
    public function songs()
    {
        return $this-&gt;hasMany(&#39;App\Song&#39;);
    }
}


class Song extends Model {
    protected $fillable = [&#39;album_id&#39;, &#39;title&#39;, &#39;length&#39;];
    public function album()
    {
        return $this-&gt;belongsTo(&#39;App\Album&#39;);
    }
}
</pre></div>
</div>
<p>penggunaan hasmanythrough  nantinya data artists akan langsung bisa mendapatkan tabel songs tanpa perlu adanya relasi ke tabel albums</p>
<p><code class="docutils literal"><span class="pre">App\Artist::find(1)-&gt;songs;</span></code></p>
</div>
<div class="section" id="mendefinisikan-relationship-di-laravel">
<h2><a class="toc-backref" href="#id27">1.10&nbsp;&nbsp;&nbsp;Mendefinisikan <cite>Relationship</cite> di Laravel</a><a class="headerlink" href="#mendefinisikan-relationship-di-laravel" title="Permalink to this headline">¶</a></h2>
<div class="section" id="polymorph-relation">
<h3><a class="toc-backref" href="#id28">1.10.1&nbsp;&nbsp;&nbsp;<cite>Polymorph Relation</cite></a><a class="headerlink" href="#polymorph-relation" title="Permalink to this headline">¶</a></h3>
<p>Relasi polymorph adalah relasi antar tabel yang mana satu tabel dapat memiliki lebih dari satu asosiasi tunggal pada tabel.</p>
<p>Relasi antar tabel biasanya adalah dari relasi <code class="docutils literal"><span class="pre">parent-child</span> <span class="pre">one-many</span></code> (seperti one to one, one to many atau many to many).</p>
<p>Dimana syarat utamanya adalah tabel child harus memberikan adanya <cite>foreign key</cite> yang terhubung dengan primary key dari parent table</p>
<p>Seperti relasi antara table <cite>artists</cite> dengan <cite>albums</cite>, maka pada tabel <cite>albums</cite> harus terdapat adanya field foreign key yang merelasikan dengan tabel <cite>artists</cite> semisal field <cite>artist_id</cite>.</p>
<p>Namun dalam polymorph maka suatu tabel akan memiliki <cite>semacam</cite> foreign key yang merelasikan ke 2 tabel yang berbeda.</p>
<p>Jika dilihat secara sekilas, maka tabel polymorph adalah tabel child yang menyediakan adanya foreign key.</p>
<p>Contoh penggunaan polymorph adalah seperti misalkan terdapat adanya tabel <code class="docutils literal"><span class="pre">staff</span></code> dan <code class="docutils literal"><span class="pre">products</span></code>, kemudian terdapat adanya penambahan fitur photo (path file) dalam menangani kedua tabel tersebut.</p>
<p>tentu akan sangat merepotkan jika memberikan adanya field <cite>path_file</cite> pada kedua tabel tersebut.</p>
<p>Akan jauh lebih mudah jika terdapat satu tabel dalam memanage path file dari kedua tabel tersebut.</p>
<p>Tabel tersebut akan berisikan field <cite>imageable_id</cite> dan <cite>imageable_type</cite> dalam menangani kedua tabel tersebut.</p>
<p>field <cite>imageable_id</cite> akan menjadi foreign key sedangkan <cite>imageable_type</cite> akan menentukan tabel mana yang direlasikan</p>
<p>kurang lebihnya adalah seperti berikut</p>
<ul class="simple">
<li>staff<ul>
<li>id - integer</li>
<li>name - string</li>
</ul>
</li>
<li>products<ul>
<li>id - integer</li>
<li>price - integer</li>
</ul>
</li>
<li>photos<ul>
<li>id - integer</li>
<li>path - string</li>
<li>imageable_id - integer</li>
<li>imageable_type - string</li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Dalam polymorph antara tabel yang berhubungan tidak akan dapat diberikan adanya asosiasi constraint.</p>
<p>Karena asosiasi constraint hanya dapat diberikan dalam satu target tabel yang saling berelasi.</p>
<p>Foreign key dalam tabel polymorph tidak dapat digunakan untuk constraint pada lebih dari satu tabel.</p>
<p class="last">Selain itu masih dibutuhkan adanya satu column untuk bagian seleksi yang mana satu kolom tersebut adalah penentu penggunaan tabel relasi mana yang akan dipilih.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Asosiasi di Polymorph tidak dipergunakan pada sisi database itu sendiri namun biasanya ini dipergunakan pada sisi back end, yaitu dijadikan sebagai model.</p>
<p class="last">Laravel sendiri juga telah menyediakan method khusus pada eloquent dalam menangani polymorph ini.</p>
</div>
<p>Untuk dapat menggunakan fitur polymorph di laravel, diperlukan adanya 2 field pada tabel polymorph, secara default laravel menggunakan penamaan dengan prefix (awalan) adalah nama field (bisa juga nama tabel polymorph) dan suffix (akhiran) <cite>able</cite> pada kedua field tersebut.</p>
<p>Selanjutnya adalah penambahan <cite>_id</cite> dan <cite>_type</cite>, <cite>_id</cite> digunakan sebagai foreign key dan <cite>_type</cite> sebagai pemilih tabel yang akan direlasikan.</p>
<p>Laravel juga telah menyediakan pembuatan field khusus relasi polymorph ini dari <cite>migration</cite>, yaitu dengan function <code class="docutils literal"><span class="pre">morphs</span></code> dengan parameter adalah nama field nya</p>
<p>berikut contohnya.</p>
<p>Tabel <code class="docutils literal"><span class="pre">staff</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateStaffTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;staff&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;string(&#39;name&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;staff&#39;);
    }
}
</pre></div>
</div>
<p>Tabel <code class="docutils literal"><span class="pre">products</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateProductTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;products&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;string(&#39;name&#39;);
            $table-&gt;integer(&#39;price&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;products&#39;);
    }
}
</pre></div>
</div>
<p>Tabel <code class="docutils literal"><span class="pre">Photos</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreatePhotosTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;photos&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;text(&#39;path&#39;);
            $table-&gt;morphs(&#39;imageable&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;photos&#39;);
    }
}
</pre></div>
</div>
<div class="highlight-rst"><div class="highlight"><pre><span></span>Hasil dari migrasi diatas

mysql&gt; desc staff;
+------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> Field      | Type             | Null | Key | Default             | Extra          |
+------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> id         | int(10) unsigned | NO   | PRI | NULL                | auto_increment |
<span class="o">|</span> name       | varchar(255)     | NO   |     | NULL                |                |
<span class="o">|</span> created_at | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
<span class="o">|</span> updated_at | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
+------------+------------------+------+-----+---------------------+----------------+
4 rows in set (0,00 sec)

mysql&gt; desc products;
+------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> Field      | Type             | Null | Key | Default             | Extra          |
+------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> id         | int(10) unsigned | NO   | PRI | NULL                | auto_increment |
<span class="o">|</span> name       | varchar(255)     | NO   |     | NULL                |                |
<span class="o">|</span> price      | int(11)          | NO   |     | NULL                |                |
<span class="o">|</span> created_at | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
<span class="o">|</span> updated_at | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
+------------+------------------+------+-----+---------------------+----------------+
5 rows in set (0,00 sec)

mysql&gt; desc photos;
+----------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> Field          | Type             | Null | Key | Default             | Extra          |
+----------------+------------------+------+-----+---------------------+----------------+
<span class="o">|</span> id             | int(10) unsigned | NO   | PRI | NULL                | auto_increment |
<span class="o">|</span> path           | text             | NO   |     | NULL                |                |
<span class="o">|</span> imageable_id   | int(10) unsigned | NO   | MUL | NULL                |                |
<span class="o">|</span> imageable_type | varchar(255)     | NO   |     | NULL                |                |
<span class="o">|</span> created_at     | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
<span class="o">|</span> updated_at     | timestamp        | NO   |     | 0000-00-00 00:00:00 |                |
+----------------+------------------+------+-----+---------------------+----------------+
6 rows in set (0,00 sec)
</pre></div>
</div>
<p>Kemudian mendefinisikan relasi dari model</p>
<p>Model <code class="docutils literal"><span class="pre">Photos</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Photo extends Model
{
    protected $fillable = [
        &#39;path&#39;,
        &#39;imageable_id&#39;,
        &#39;imageable_type&#39;
    ];

    public function imageable() {
        return $this-&gt;morphTo();
    }
}
</pre></div>
</div>
<p>Model <code class="docutils literal"><span class="pre">Product</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Product extends Model
{
    protected $fillable = [
        &#39;name&#39;,
        &#39;price&#39;
    ];

    public function photos() {
        return $this-&gt;morphMany(&#39;App\Photo&#39;,&#39;imageable&#39;);
    }
}
</pre></div>
</div>
<p>Model <code class="docutils literal"><span class="pre">Staff</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Staff extends Model
{
    protected $fillable = [
        &#39;name&#39;
    ];

    public function photos() {
        return $this-&gt;morphMany(&#39;App\Photo&#39;,&#39;imageable&#39;);
    }
}
</pre></div>
</div>
<p>Untuk sample isian datanya contohnya seperti berikut:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">staff</span><span class="p">;</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">arif</span>   <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">28</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">28</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">rohman</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">33</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">33</span> <span class="o">|</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">products</span><span class="p">;</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">price</span>    <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">laptop</span> <span class="o">|</span> <span class="mi">50000000</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">PC</span>     <span class="o">|</span> <span class="mi">40000000</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">23</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">23</span> <span class="o">|</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">photos</span><span class="p">;</span>
<span class="o">+----+-------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">path</span>                          <span class="o">|</span> <span class="n">imageable_id</span> <span class="o">|</span> <span class="n">imageable_type</span> <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+-------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">laptop</span><span class="o">-</span><span class="n">acer</span><span class="o">.</span><span class="n">jpg</span> <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Product</span>    <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">39</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">39</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">pc</span><span class="o">-</span><span class="n">intel</span><span class="o">.</span><span class="n">jpg</span>    <span class="o">|</span>            <span class="mi">2</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Product</span>    <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">arif</span><span class="o">.</span><span class="n">jpg</span>        <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Staff</span>      <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">57</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">57</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">rohman</span><span class="o">.</span><span class="n">jpg</span>      <span class="o">|</span>            <span class="mi">2</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Staff</span>      <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">06</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">06</span> <span class="o">|</span>
<span class="o">+----+-------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="mi">4</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p class="last">data diatas diinput manual satu persatu dan belum menggunakan fitur yang dapat menyimpan(insert) atau memperbaharui(update) dari relasi polymorph, nanti akan dijelaskan setelah beberapa bagian dasar berikut.</p>
</div>
</div>
<div class="section" id="pendefinisian-relasi-polymorph">
<h3><a class="toc-backref" href="#id29">1.10.2&nbsp;&nbsp;&nbsp;Pendefinisian relasi polymorph</a><a class="headerlink" href="#pendefinisian-relasi-polymorph" title="Permalink to this headline">¶</a></h3>
<p>Untuk dapat mendefinisikan relasi polymorph menggunakan eloquent, sebaiknya definisikan dahulu beberapa hal seperti berikut:</p>
<p>Dalam eloquent terdapat 3 method utama dalam mendefinisikan relasi polymorph yaitu:</p>
<ul class="simple">
<li>morph<ul>
<li>morphOne</li>
<li>morphMany</li>
<li>morphOneOrMany</li>
</ul>
</li>
<li>morphTo<ul>
<li>morphTo</li>
<li>morphToMany</li>
</ul>
</li>
<li>morphedBy<ul>
<li>morphedByMany</li>
</ul>
</li>
</ul>
<div class="section" id="morph">
<h4><a class="toc-backref" href="#id30">1.10.2.1&nbsp;&nbsp;&nbsp;morph</a><a class="headerlink" href="#morph" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">morph</span></code> adalah untuk merelasikan antara model parent dengan model child (polymorph model).
Relasi ini ditulis di model parent.</p>
<p>syntax:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>__construct(Builder $query, Model $parent, string $type, string $id, string $localKey)
</pre></div>
</div>
<p>Struktur untuk semua jenis morph sama (morphOne, morphMany dan morphOneOrMany).</p>
<p>Perbedaan yang menjadi dasar adalah dari jenis hasil datanya yaitu apakah tunggal (one) atau jamak (many).</p>
<p>Jika dari kasus diatas, kalau maka relasi antara staff/products ke photos adalah one to many, atau satu data di staff/products akan memiliki lebih dari satu data di photos</p>
<p>Namun berikut mari kita bedakan sedikit agar jauh lebih jelas perbedaanya, yaitu pada model <code class="docutils literal"><span class="pre">Staff</span></code> akan kita berikan relasi morphOne, sedangkan model <code class="docutils literal"><span class="pre">Product</span></code> akan kita berikan relasi morphMany.</p>
<p>pengubahan model <code class="docutils literal"><span class="pre">Staff</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Staff extends Model
{
    protected $fillable = [
        &#39;name&#39;
    ];

    public function photos() {
        return $this-&gt;morphOne(&#39;App\Photo&#39;,&#39;imageable&#39;);
    }
}
</pre></div>
</div>
<img alt="_images/polymorphmorphonemany.png" src="_images/polymorphmorphonemany.png" />
<p>Hasilnya adalah akan ketika menggunakan relasi dari staff ke photos, maka hanya ada satu data object yang tersedia, sedangkan ketika menggunakan relasi dari products ke photos, maka terdapat adanya list array (bisa lebih dari satu) data object yang tersedia,</p>
<p>Akan jauh lebih jelas lagi jika memberikan tambahan data dari model photos</p>
<div class="highlight-rst"><div class="highlight"><pre><span></span>mysql&gt; SELECT * FROM photos;
+----+--------------------------------+--------------+----------------+---------------------+---------------------+
<span class="o">|</span> id | path                           | imageable_id | imageable_type | created_at          | updated_at          |
+----+--------------------------------+--------------+----------------+---------------------+---------------------+
<span class="o">|</span>  1 | public/images/laptop-acer.jpg  |            1 | App\Product    | 2017-02-21 04:46:39 | 2017-02-21 04:46:39 |
<span class="o">|</span>  2 | public/images/pc-intel.jpg     |            2 | App\Product    | 2017-02-21 04:49:38 | 2017-02-21 04:49:38 |
<span class="o">|</span>  3 | public/images/arif.jpg         |            1 | App\Staff      | 2017-02-21 04:49:57 | 2017-02-21 04:49:57 |
<span class="o">|</span>  4 | public/images/rohman.jpg       |            2 | App\Staff      | 2017-02-21 04:50:06 | 2017-02-21 04:50:06 |
<span class="o">|</span>  5 | public/image/arif02.jpg        |            1 | App\Staff      | 2017-02-21 06:15:36 | 2017-02-21 06:15:36 |
<span class="o">|</span>  6 | public/image/laptop-acer02.jpg |            1 | App\Product    | 2017-02-21 06:16:14 | 2017-02-21 06:16:14 |
+----+--------------------------------+--------------+----------------+---------------------+---------------------+
6 rows in set (0,00 sec)
</pre></div>
</div>
<img alt="_images/polymorphmorphonemany2.png" src="_images/polymorphmorphonemany2.png" />
<p>perbedaan antara morphMany dan MorphOne adalah tergantung pada hasil relasi yang dapat diberikan.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Untuk morphOneOrMany masih belum diketahui dimana perbedaannya.</p>
</div>
<div class="section" id="morphto">
<h5><a class="toc-backref" href="#id31">1.10.2.1.1&nbsp;&nbsp;&nbsp;morphTo</a><a class="headerlink" href="#morphto" title="Permalink to this headline">¶</a></h5>
<p>Terdapat 2 jenis <code class="docutils literal"><span class="pre">morphTo</span></code> yaitu <code class="docutils literal"><span class="pre">morphTo</span></code> dan <code class="docutils literal"><span class="pre">morphToMany</span></code>, keduanya memiliki adanya perbedaan dalam penggunaan.</p>
<p><cite>morphTo</cite> digunakan pada tabel poymorph, dimana ini dideklarasikan pada method yang akan digunakan oleh tabel polymorph itu sendiri.</p>
<p>dari kasus diatas, tabel polymorph adalah tabel <code class="docutils literal"><span class="pre">photos</span></code> artinya kita akan mendeklarasikan adanya relasi <cite>morphTo</cite> ini.</p>
<p>Model <code class="docutils literal"><span class="pre">Photos</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Photo extends Model
{
    protected $fillable = [
        &#39;path&#39;,
        &#39;imageable_id&#39;,
        &#39;imageable_type&#39;
    ];

    public function imageable() {
        return $this-&gt;morphTo();
    }
}
</pre></div>
</div>
<p>Nama method untuk relasi ini sebaiknya mengikuti nama fieldnya.</p>
<img alt="_images/polymorphmorphto.png" src="_images/polymorphmorphto.png" />
<div class="admonition caution">
<p class="first admonition-title">Caution</p>
<p>Untuk jenis <code class="docutils literal"><span class="pre">morphToMany</span></code> sebenarnya ini digunakan pada relasi <code class="docutils literal"><span class="pre">polymorph</span> <span class="pre">many</span> <span class="pre">to</span> <span class="pre">many</span></code> yang juga mempergunakan jenis <code class="docutils literal"><span class="pre">morphedByMany</span></code>.</p>
<p class="last">Untuk itu maka akan dibahas menjadi satu mengenai <code class="docutils literal"><span class="pre">Many</span> <span class="pre">to</span> <span class="pre">Many</span> <span class="pre">Polymorph</span> <span class="pre">Relation</span></code></p>
</div>
</div>
<div class="section" id="many-to-many-polymorph-relation">
<h5><a class="toc-backref" href="#id32">1.10.2.1.2&nbsp;&nbsp;&nbsp;<cite>Many to Many Polymorph Relation</cite></a><a class="headerlink" href="#many-to-many-polymorph-relation" title="Permalink to this headline">¶</a></h5>
<p>Polymorph juga dapat memiliki bentuk many to many dimana tabel polymorph itu akan merelasikan data tabel ke lebih dari satu ke tabel parent.</p>
<p>Artinya data yang berelasi dengan tabel parent itu <cite>berdiri sendiri</cite> dan akan direlasikan melalui many to many.</p>
<p>Contoh mudahnya adalah pada contoh diatas yaitu tabel <code class="docutils literal"><span class="pre">staff</span></code>, <code class="docutils literal"><span class="pre">products</span></code>, dan <code class="docutils literal"><span class="pre">photos</span></code>.</p>
<p>tabel <code class="docutils literal"><span class="pre">photos</span></code> adalah tabel polymorph yang memuat foreign key dari kedua tabel, namun di dalam tabel ini juga memuat adanya data <code class="docutils literal"><span class="pre">filepath</span></code>.</p>
<p>jika melihat struktur diatas, artinya data di tabel <code class="docutils literal"><span class="pre">photos</span></code> ini adalah data tunggal mengacu kepada adanya data <code class="docutils literal"><span class="pre">filepath</span></code>, karena satu atau lebih data photos hanya untuk satu data staff atau products.</p>
<p>Yang artinya kemungkinan data di tabel staff dan products tidak akan memiliki data yang sama kepada tabel photos.</p>
<p>Lebih jelasnya dapat melihat tabel berikut:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">photos</span><span class="p">;</span>
<span class="o">+----+--------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">path</span>                           <span class="o">|</span> <span class="n">imageable_id</span> <span class="o">|</span> <span class="n">imageable_type</span> <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+--------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">laptop</span><span class="o">-</span><span class="n">acer</span><span class="o">.</span><span class="n">jpg</span>  <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Product</span>    <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">39</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="mi">39</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">pc</span><span class="o">-</span><span class="n">intel</span><span class="o">.</span><span class="n">jpg</span>     <span class="o">|</span>            <span class="mi">2</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Product</span>    <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">38</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">3</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">arif</span><span class="o">.</span><span class="n">jpg</span>         <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Staff</span>      <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">57</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">57</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">4</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">images</span><span class="o">/</span><span class="n">rohman</span><span class="o">.</span><span class="n">jpg</span>       <span class="o">|</span>            <span class="mi">2</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Staff</span>      <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">06</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">06</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">5</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">arif02</span><span class="o">.</span><span class="n">jpg</span>        <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Staff</span>      <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">06</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">36</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">06</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mi">36</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">6</span> <span class="o">|</span> <span class="n">public</span><span class="o">/</span><span class="n">image</span><span class="o">/</span><span class="n">laptop</span><span class="o">-</span><span class="n">acer02</span><span class="o">.</span><span class="n">jpg</span> <span class="o">|</span>            <span class="mi">1</span> <span class="o">|</span> <span class="n">App</span>\<span class="n">Product</span>    <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">06</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">06</span><span class="p">:</span><span class="mi">16</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span>
<span class="o">+----+--------------------------------+--------------+----------------+---------------------+---------------------+</span>
<span class="mi">6</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">staff</span><span class="p">;</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">arif</span>   <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">28</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">28</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">rohman</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">33</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">33</span> <span class="o">|</span>
<span class="o">+----+--------+---------------------+---------------------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">products</span><span class="p">;</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="o">|</span> <span class="nb">id</span> <span class="o">|</span> <span class="n">name</span>   <span class="o">|</span> <span class="n">price</span>    <span class="o">|</span> <span class="n">created_at</span>          <span class="o">|</span> <span class="n">updated_at</span>          <span class="o">|</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="o">|</span>  <span class="mi">1</span> <span class="o">|</span> <span class="n">laptop</span> <span class="o">|</span> <span class="mi">50000000</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">14</span> <span class="o">|</span>
<span class="o">|</span>  <span class="mi">2</span> <span class="o">|</span> <span class="n">PC</span>     <span class="o">|</span> <span class="mi">40000000</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">23</span> <span class="o">|</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">21</span> <span class="mi">04</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">23</span> <span class="o">|</span>
<span class="o">+----+--------+----------+---------------------+---------------------+</span>
<span class="mi">2</span> <span class="n">rows</span> <span class="ow">in</span> <span class="nb">set</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">00</span> <span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>Jika dimisalkan, mungkin tidak data staff dengan nama <code class="docutils literal"><span class="pre">arif</span></code> dan data products dengan nama  <cite>laptop</cite> dapat memiliki data tabel photos dengan path <cite>public/images/laptop-acer.jpg</cite>.</p>
<p>Jawabnya tidak mungkin, ini dikarenakan tabel photos tidak berdiri sendiri dan menjadi data tunggal.</p>
<p>Kemudian apa yang dimaksud dengan <code class="docutils literal"><span class="pre">Many</span> <span class="pre">to</span> <span class="pre">Many</span> <span class="pre">Polymorph</span> <span class="pre">Relation</span></code> ???</p>
<p>Sebenarnya bisa saja kita memodifikasi contoh studi kasus diatas menjadi <code class="docutils literal"><span class="pre">Many</span> <span class="pre">to</span> <span class="pre">Many</span> <span class="pre">Polymorph</span> <span class="pre">Relation</span></code>, namun alangkah baiknya kita  menggunakan contoh lain yang berbeda.</p>
<p>Misalkan saja terdapat tabel <code class="docutils literal"><span class="pre">posts</span></code>, <code class="docutils literal"><span class="pre">videos</span></code>, dan <code class="docutils literal"><span class="pre">tags</span></code>.</p>
<p>Ketiga tiganya datanya berdiri sendiri,(tabel <cite>tags</cite> juga memiliki data tunggal yang berdiri sendiri).</p>
<p>Dan kita akan melakukan adanya polymorph dari tabel <code class="docutils literal"><span class="pre">tags</span></code>, maka dari itu dibutuhkan adanya satu tabel lagi dalam merelasikan antara tabel <code class="docutils literal"><span class="pre">tags</span></code> ke tabel <code class="docutils literal"><span class="pre">posts</span></code> atau <code class="docutils literal"><span class="pre">videos</span></code>, yaitu tabel <code class="docutils literal"><span class="pre">taggables</span></code>.</p>
<p>Untuk dapat melakukannya dapat melihat struktur tabel berikut</p>
<ul class="simple">
<li>videos<ul>
<li><code class="docutils literal"><span class="pre">id</span></code></li>
<li>title</li>
<li>link</li>
</ul>
</li>
<li>posts<ul>
<li><code class="docutils literal"><span class="pre">id</span></code></li>
<li>title</li>
<li>content</li>
</ul>
</li>
<li>tags<ul>
<li><code class="docutils literal"><span class="pre">id</span></code></li>
<li>name</li>
</ul>
</li>
<li>taggable<ul>
<li><code class="docutils literal"><span class="pre">id</span></code></li>
<li>tag_id</li>
<li>taggable_id</li>
<li>taggable_type</li>
</ul>
</li>
</ul>
<p>tabel <code class="docutils literal"><span class="pre">videos</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateVideosTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;videos&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;string(&#39;title&#39;);
            $table-&gt;text(&#39;link&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;videos&#39;);
    }
}
</pre></div>
</div>
<p>tabel <code class="docutils literal"><span class="pre">posts</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreatePostsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;posts&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;string(&#39;title&#39;);
            $table-&gt;text(&#39;content&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;posts&#39;);
    }
}
</pre></div>
</div>
<p>tabel <code class="docutils literal"><span class="pre">tags</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateTagsTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;tags&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;string(&#39;name&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;tags&#39;);
    }
}
</pre></div>
</div>
<p>tabel <code class="docutils literal"><span class="pre">taggable</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

use Illuminate\Database\Schema\Blueprint;
use Illuminate\Database\Migrations\Migration;

class CreateTaggablesTable extends Migration
{
    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create(&#39;taggables&#39;, function (Blueprint $table) {
            $table-&gt;increments(&#39;id&#39;);
            $table-&gt;integer(&#39;tag_id&#39;);
            $table-&gt;morphs(&#39;taggable&#39;);
            $table-&gt;index(&#39;tag_id&#39;);
            $table-&gt;timestamps();
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop(&#39;taggables&#39;);
    }
}
</pre></div>
</div>
<p>model Post:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Post extends Model
{
    protected $fillable = [
        &#39;title&#39;,
        &#39;content&#39;
    ];

    public function tags()
    {
        return $this-&gt;morphToMany(&#39;App\Tag&#39;, &#39;taggable&#39;);
    }
}
</pre></div>
</div>
<p>model Video:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Video extends Model
{
    protected $fillable = [
        &#39;title&#39;,
        &#39;link&#39;
    ];

    public function tags()
    {
        return $this-&gt;morphToMany(&#39;App\Tag&#39;, &#39;taggable&#39;);
    }
}
</pre></div>
</div>
<p>model Tag:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>&lt;?php

namespace App;

use Illuminate\Database\Eloquent\Model;

class Tag extends Model
{
    protected $fillable = [
        &#39;name&#39;
    ];

    public function posts()
    {
        return $this-&gt;morphedByMany(&#39;App\Post&#39;, &#39;taggable&#39;);
    }

    public function videos()
    {
        return $this-&gt;morphedByMany(&#39;App\Video&#39;, &#39;taggable&#39;);
    }
}
</pre></div>
</div>
<p>Seperti yang diketahui bahwa kita akan membuat adanya relasi polymorph dengan bentuk many to many, dimana satu data di tabel tags dapat diisi kan ke tabel lain.</p>
<p>Untuk memudahkan adanya penggunaan polymorph sebelumnya dapat mengisikan beberapa data seperti berikut:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>mysql&gt; SELECT * FROM videos;
+----+-----------+----------------------------------------------+---------------------+---------------------+
| id | title     | link                                         | created_at          | updated_at          |
+----+-----------+----------------------------------------------+---------------------+---------------------+
|  1 | video one | https://www.youtube.com/watch?v=-LCsm14iUo0  | 2017-02-22 11:03:37 | 2017-02-22 11:03:37 |
|  2 | video two | https://www.youtube.com/watch?v=-dgGsljgS803 | 2017-02-22 11:03:52 | 2017-02-22 11:03:52 |
+----+-----------+----------------------------------------------+---------------------+---------------------+
2 rows in set (0,00 sec)

mysql&gt; SELECT * FROM posts;
+----+----------------+------------------+---------------------+---------------------+
| id | title          | content          | created_at          | updated_at          |
+----+----------------+------------------+---------------------+---------------------+
|  1 | title post one | content post one | 2017-02-22 11:03:04 | 2017-02-22 11:03:04 |
|  2 | title post two | content post two | 2017-02-22 11:03:16 | 2017-02-22 11:03:16 |
+----+----------------+------------------+---------------------+---------------------+
2 rows in set (0,00 sec)

mysql&gt; SELECT * FROM tags;
+----+------------+---------------------+---------------------+
| id | name       | created_at          | updated_at          |
+----+------------+---------------------+---------------------+
|  1 | fashion    | 2017-02-22 11:04:11 | 2017-02-22 11:04:11 |
|  2 | life style | 2017-02-22 11:04:18 | 2017-02-22 11:04:18 |
+----+------------+---------------------+---------------------+
2 rows in set (0,00 sec)

mysql&gt; SELECT * FROM taggables;
+----+--------+-------------+---------------+---------------------+---------------------+
| id | tag_id | taggable_id | taggable_type | created_at          | updated_at          |
+----+--------+-------------+---------------+---------------------+---------------------+
|  1 |      1 |           1 | App\Post      | 2017-02-22 18:03:00 | 2017-02-22 18:03:00 |
|  2 |      1 |           2 | App\Video     | 2017-02-22 18:03:00 | 2017-02-22 18:03:00 |
|  3 |      2 |           1 | App\Post      | 2017-02-22 18:03:00 | 2017-02-22 18:03:00 |
+----+--------+-------------+---------------+---------------------+---------------------+
3 rows in set (0,00 sec)
</pre></div>
</div>
<p>Jika dilihat berarti Video dengan <code class="docutils literal"><span class="pre">id</span></code> 2 yang hanya memiliki adanya relasi polymorph</p>
<img alt="_images/polymorphmanytomany.png" src="_images/polymorphmanytomany.png" />
<p>Artinya adalah field <code class="docutils literal"><span class="pre">taggable_id</span></code> adalah foreign key dari tabel parent(<code class="docutils literal"><span class="pre">posts</span></code> atau <code class="docutils literal"><span class="pre">videos</span></code>) sedangkan field <code class="docutils literal"><span class="pre">taggable_type</span></code> adalah tabel yang akan dijadikan tabel parent.</p>
<p>Untuk field <code class="docutils literal"><span class="pre">tag_id</span></code> ini adalah field foreign key dari tabel <code class="docutils literal"><span class="pre">tags</span></code>.</p>
<img alt="_images/polymorphmanytomany2.png" src="_images/polymorphmanytomany2.png" />
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">sangat disarankan untuk memberikan nama field primary key <code class="docutils literal"><span class="pre">tag_id</span></code> pada tabel <code class="docutils literal"><span class="pre">taggable</span></code>, karena itu adalah key default laravel untuk morphToMany</p>
</div>
<div class="section" id="insert-dan-update-data-pada-relasi-polymorph">
<h6><a class="toc-backref" href="#id33">1.10.2.1.2.1&nbsp;&nbsp;&nbsp;Insert dan Update data pada relasi polymorph</a><a class="headerlink" href="#insert-dan-update-data-pada-relasi-polymorph" title="Permalink to this headline">¶</a></h6>
<p>Untuk mengingatkan bahwa ketika kita telah menyelesaikan mekanisme penyimpanan dan pengubahahn menggunakan eloquent (create dan update) maka kita dapat menggunakan variabel berisikan mekanisme create dan update tersebut untuk dapat menyimpan foreign key di tabel child</p>
<p>untuk many to many polymorph dapat menggunakan attach method</p>
<img alt="_images/polymorphsave.png" src="_images/polymorphsave.png" />
</div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="relationship-eloquent.html" class="btn btn-neutral float-right" title="Relationship" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="database.html" class="btn btn-neutral" title="Database" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, ryan.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.01',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>